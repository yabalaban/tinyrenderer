/* Generated by the Nim Compiler v1.6.14 */
var framePtr = null;
var excHandler = 0;
var lastJSError = null;
var NTI469762088 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI469762087 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI469762086 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI469762075 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI469762084 = {size: 0, kind: 16, base: null, node: null, finalizer: null};
var NTI469762081 = {size: 0, kind: 16, base: null, node: null, finalizer: null};
var NTI469762073 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI469762416 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI469762407 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI469762398 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI469762450 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI989856072 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI33555114 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555125 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI989856224 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI469762180 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI33555121 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555124 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI469762181 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI469762071 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI33554456 = {size: 0,kind: 31,base: null,node: null,finalizer: null};
var NTI469762165 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI33555128 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555130 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555083 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555165 = {size: 0, kind: 22, base: null, node: null, finalizer: null};
var NTI33554439 = {size: 0,kind: 28,base: null,node: null,finalizer: null};
var NTI33554440 = {size: 0,kind: 29,base: null,node: null,finalizer: null};
var NTI33555164 = {size: 0, kind: 22, base: null, node: null, finalizer: null};
var NTI33555112 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555113 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555120 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555122 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33554435 = {size: 0,kind: 36,base: null,node: null,finalizer: null};
var NTI1157627907 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NNI1157627907 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "x", len: 0, typ: NTI33554435, name: "x", sons: null}, 
{kind: 1, offset: "y", len: 0, typ: NTI33554435, name: "y", sons: null}, 
{kind: 1, offset: "z", len: 0, typ: NTI33554435, name: "z", sons: null}]};
NTI1157627907.node = NNI1157627907;
var NNI33555122 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555122.node = NNI33555122;
var NNI33555120 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555120.node = NNI33555120;
var NNI33555113 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555113.node = NNI33555113;
NTI33555164.base = NTI33555112;
NTI33555165.base = NTI33555112;
var NNI33555112 = {kind: 2, len: 5, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "parent", len: 0, typ: NTI33555164, name: "parent", sons: null}, 
{kind: 1, offset: "name", len: 0, typ: NTI33554440, name: "name", sons: null}, 
{kind: 1, offset: "message", len: 0, typ: NTI33554439, name: "msg", sons: null}, 
{kind: 1, offset: "trace", len: 0, typ: NTI33554439, name: "trace", sons: null}, 
{kind: 1, offset: "up", len: 0, typ: NTI33555165, name: "up", sons: null}]};
NTI33555112.node = NNI33555112;
var NNI33555083 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555083.node = NNI33555083;
NTI33555112.base = NTI33555083;
NTI33555113.base = NTI33555112;
NTI33555120.base = NTI33555113;
NTI33555122.base = NTI33555120;
var NNI33555130 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555130.node = NNI33555130;
NTI33555130.base = NTI33555113;
var NNI33555128 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555128.node = NNI33555128;
NTI33555128.base = NTI33555113;
var NNI469762165 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI33554456, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554456, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI33554435, name: "Field2", sons: null}]};
NTI469762165.node = NNI469762165;
var NNI469762071 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI33554435, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554435, name: "Field1", sons: null}]};
NTI469762071.node = NNI469762071;
var NNI469762181 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI33554456, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554456, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI33554435, name: "Field2", sons: null}]};
NTI469762181.node = NNI469762181;
var NNI33555124 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555124.node = NNI33555124;
NTI33555124.base = NTI33555113;
var NNI33555121 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555121.node = NNI33555121;
NTI33555121.base = NTI33555120;
var NNI469762180 = {kind: 2, len: 8, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI33554435, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554435, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI469762181, name: "Field2", sons: null}, 
{kind: 1, offset: "Field3", len: 0, typ: NTI469762181, name: "Field3", sons: null}, 
{kind: 1, offset: "Field4", len: 0, typ: NTI469762181, name: "Field4", sons: null}, 
{kind: 1, offset: "Field5", len: 0, typ: NTI469762071, name: "Field5", sons: null}, 
{kind: 1, offset: "Field6", len: 0, typ: NTI469762071, name: "Field6", sons: null}, 
{kind: 1, offset: "Field7", len: 0, typ: NTI469762071, name: "Field7", sons: null}]};
NTI469762180.node = NNI469762180;
NTI989856224.base = NTI33554439;
var NNI33555125 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555125.node = NNI33555125;
var NNI33555114 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555114.node = NNI33555114;
NTI33555114.base = NTI33555112;
NTI33555125.base = NTI33555114;
NTI989856072.base = NTI33554439;
var NNI469762450 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI33554456, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554456, name: "Field1", sons: null}]};
NTI469762450.node = NNI469762450;
NTI469762398.base = NTI1157627907;
NTI469762407.base = NTI469762071;
NTI469762081.base = NTI33554456;
NTI469762084.base = NTI33554456;
var NNI469762073 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "v", len: 0, typ: NTI469762081, name: "v", sons: null}, 
{kind: 1, offset: "t", len: 0, typ: NTI469762084, name: "t", sons: null}]};
NTI469762073.node = NNI469762073;
NTI469762416.base = NTI469762073;
NTI469762086.base = NTI1157627907;
NTI469762087.base = NTI469762071;
NTI469762088.base = NTI469762073;
var NNI469762075 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "vertices", len: 0, typ: NTI469762086, name: "vertices", sons: null}, 
{kind: 1, offset: "texCoords", len: 0, typ: NTI469762087, name: "texCoords", sons: null}, 
{kind: 1, offset: "faces", len: 0, typ: NTI469762088, name: "faces", sons: null}]};
NTI469762075.node = NNI469762075;

function setConstr() {
        var result = {};
    for (var i = 0; i < arguments.length; ++i) {
      var x = arguments[i];
      if (typeof(x) == "object") {
        for (var j = x[0]; j <= x[1]; ++j) {
          result[j] = true;
        }
      } else {
        result[x] = true;
      }
    }
    return result;
  

  
}
var ConstSet1 = setConstr(17, 16, 4, 18, 27, 19, 23, 22, 21);

function nimCopy(dest_33557140, src_33557141, ti_33557142) {
  var result_33557151 = null;

    switch (ti_33557142.kind) {
    case 21:
    case 22:
    case 23:
    case 5:
      if (!(isFatPointer_33557131(ti_33557142))) {
      result_33557151 = src_33557141;
      }
      else {
        result_33557151 = [src_33557141[0], src_33557141[1]];
      }
      
      break;
    case 19:
            if (dest_33557140 === null || dest_33557140 === undefined) {
        dest_33557140 = {};
      }
      else {
        for (var key in dest_33557140) { delete dest_33557140[key]; }
      }
      for (var key in src_33557141) { dest_33557140[key] = src_33557141[key]; }
      result_33557151 = dest_33557140;
    
      break;
    case 18:
    case 17:
      if (!((ti_33557142.base == null))) {
      result_33557151 = nimCopy(dest_33557140, src_33557141, ti_33557142.base);
      }
      else {
      if ((ti_33557142.kind == 17)) {
      result_33557151 = (dest_33557140 === null || dest_33557140 === undefined) ? {m_type: ti_33557142} : dest_33557140;
      }
      else {
        result_33557151 = (dest_33557140 === null || dest_33557140 === undefined) ? {} : dest_33557140;
      }
      }
      nimCopyAux(result_33557151, src_33557141, ti_33557142.node);
      break;
    case 24:
    case 4:
    case 27:
    case 16:
            if (src_33557141 === null) {
        result_33557151 = null;
      }
      else {
        if (dest_33557140 === null || dest_33557140 === undefined || dest_33557140.length != src_33557141.length) {
          dest_33557140 = new Array(src_33557141.length);
        }
        result_33557151 = dest_33557140;
        for (var i = 0; i < src_33557141.length; ++i) {
          result_33557151[i] = nimCopy(result_33557151[i], src_33557141[i], ti_33557142.base);
        }
      }
    
      break;
    case 28:
            if (src_33557141 !== null) {
        result_33557151 = src_33557141.slice(0);
      }
    
      break;
    default: 
      result_33557151 = src_33557141;
      break;
    }

  return result_33557151;

}

function makeNimstrLit(c_33556801) {
      var result = [];
  for (var i = 0; i < c_33556801.length; ++i) {
    result[i] = c_33556801.charCodeAt(i);
  }
  return result;
  

  
}

function mnewString(len_33556893) {
        return new Array(len_33556893);
  

  
}

function toJSStr(s_33556807) {
                    var Temporary5;

  var result_33556808 = null;

    var res_33556842 = newSeq_33556825((s_33556807).length);
    var i_33556843 = 0;
    var j_33556844 = 0;
    Label1: do {
        Label2: while (true) {
        if (!(i_33556843 < (s_33556807).length)) break Label2;
          var c_33556845 = s_33556807[i_33556843];
          if ((c_33556845 < 128)) {
          res_33556842[j_33556844] = String.fromCharCode(c_33556845);
          i_33556843 += 1;
          }
          else {
            var helper_33556857 = newSeq_33556825(0);
            Label3: do {
                Label4: while (true) {
                if (!true) break Label4;
                  var code_33556858 = c_33556845.toString(16);
                  if ((((code_33556858) == null ? 0 : (code_33556858).length) == 1)) {
                  helper_33556857.push("%0");;
                  }
                  else {
                  helper_33556857.push("%");;
                  }
                  
                  helper_33556857.push(code_33556858);;
                  i_33556843 += 1;
                    if (((s_33556807).length <= i_33556843)) Temporary5 = true; else {                      Temporary5 = (s_33556807[i_33556843] < 128);                    }                  if (Temporary5) {
                  break Label3;
                  }
                  
                  c_33556845 = s_33556807[i_33556843];
                }
            } while (false);
++excHandler;
            try {
            res_33556842[j_33556844] = decodeURIComponent(helper_33556857.join(""));
--excHandler;
} catch (EXCEPTION) {
 var prevJSError = lastJSError;
 lastJSError = EXCEPTION;
 --excHandler;
            res_33556842[j_33556844] = helper_33556857.join("");
            lastJSError = prevJSError;
            } finally {
            }
          }
          
          j_33556844 += 1;
        }
    } while (false);
    if (res_33556842.length < j_33556844) { for (var i = res_33556842.length ; i < j_33556844 ; ++i) res_33556842.push(null); }
               else { res_33556842.length = j_33556844; };
    result_33556808 = res_33556842.join("");

  return result_33556808;

}

function raiseException(e_33556667, ename_33556668) {
    e_33556667.name = ename_33556668;
    if ((excHandler == 0)) {
    unhandledException(e_33556667);
    }
    
    throw e_33556667;

  
}

function addInt(a_33556940, b_33556941) {
        var result = a_33556940 + b_33556941;
    checkOverflowInt(result);
    return result;
  

  
}

function chckRange(i_33557189, a_33557190, b_33557191) {
      var Temporary1;

  var result_33557192 = 0;

  BeforeRet: do {
      if (!(a_33557190 <= i_33557189)) Temporary1 = false; else {        Temporary1 = (i_33557189 <= b_33557191);      }    if (Temporary1) {
    result_33557192 = i_33557189;
    break BeforeRet;
    }
    else {
    raiseRangeError();
    }
    
  } while (false);

  return result_33557192;

}

function chckIndx(i_33557184, a_33557185, b_33557186) {
      var Temporary1;

  var result_33557187 = 0;

  BeforeRet: do {
      if (!(a_33557185 <= i_33557184)) Temporary1 = false; else {        Temporary1 = (i_33557184 <= b_33557186);      }    if (Temporary1) {
    result_33557187 = i_33557184;
    break BeforeRet;
    }
    else {
    raiseIndexError(i_33557184, a_33557185, b_33557186);
    }
    
  } while (false);

  return result_33557187;

}

function negInt(a_33556982) {
  var result_33556983 = 0;

    result_33556983 = (a_33556982 * -1);

  return result_33556983;

}

function divInt(a_33556952, b_33556953) {
        if (b_33556953 == 0) raiseDivByZero();
    if (b_33556953 == -1 && a_33556952 == 2147483647) raiseOverflow();
    return Math.trunc(a_33556952 / b_33556953);
  

  
}

function subInt(a_33556944, b_33556945) {
        var result = a_33556944 - b_33556945;
    checkOverflowInt(result);
    return result;
  

  
}

function nimMax(a_33556998, b_33556999) {
    var Temporary1;

  var result_33557000 = 0;

  BeforeRet: do {
    if ((b_33556999 <= a_33556998)) {
    Temporary1 = a_33556998;
    }
    else {
    Temporary1 = b_33556999;
    }
    
    result_33557000 = Temporary1;
    break BeforeRet;
  } while (false);

  return result_33557000;

}

function mulInt(a_33556948, b_33556949) {
        var result = a_33556948 * b_33556949;
    checkOverflowInt(result);
    return result;
  

  
}

function nimMin(a_33556994, b_33556995) {
    var Temporary1;

  var result_33556996 = 0;

  BeforeRet: do {
    if ((a_33556994 <= b_33556995)) {
    Temporary1 = a_33556994;
    }
    else {
    Temporary1 = b_33556995;
    }
    
    result_33556996 = Temporary1;
    break BeforeRet;
  } while (false);

  return result_33556996;

}
var ConstSet2 = setConstr(13, 10);
var ConstSet3 = setConstr(32, 9, 11, 13, 10, 12);
var ConstSet4 = setConstr(32, 9, 11, 13, 10, 12);
var ConstSet5 = setConstr([97, 122], [65, 90], [48, 57], 95);
var ConstSet6 = setConstr([97, 122], [65, 90], [48, 57], 95);

function addChar(x_33557255, c_33557256) {
    x_33557255.push(c_33557256);

  
}
var ConstSet7 = setConstr([48, 57]);
var ConstSet8 = setConstr([48, 57]);
var ConstSet9 = setConstr(101, 69);
var ConstSet10 = setConstr([48, 57]);
var ConstSet11 = setConstr([48, 57]);

function nimParseBiggestFloat(s_33557273, number_33557274, number_33557274_Idx, start_33557275) {
    var Temporary1;

  var result_33557276 = 0;

  BeforeRet: do {
    var sign_33557277 = false;
    var i_33557278 = start_33557275;
    if ((s_33557273[i_33557278] == 43)) {
    i_33557278 += 1;
    }
    else {
    if ((s_33557273[i_33557278] == 45)) {
    sign_33557277 = true;
    i_33557278 += 1;
    }
    }
    if (((s_33557273[i_33557278] == 78) || (s_33557273[i_33557278] == 110))) {
    if (((s_33557273[(i_33557278 + 1)] == 65) || (s_33557273[(i_33557278 + 1)] == 97))) {
    if (((s_33557273[(i_33557278 + 2)] == 78) || (s_33557273[(i_33557278 + 2)] == 110))) {
    if (!((ConstSet5[s_33557273[(i_33557278 + 3)]] != undefined))) {
    number_33557274[number_33557274_Idx] = NaN;
    result_33557276 = ((i_33557278 + 3) - start_33557275);
    break BeforeRet;
    }
    
    }
    
    }
    
    result_33557276 = 0;
    break BeforeRet;
    }
    
    if (((s_33557273[i_33557278] == 73) || (s_33557273[i_33557278] == 105))) {
    if (((s_33557273[(i_33557278 + 1)] == 78) || (s_33557273[(i_33557278 + 1)] == 110))) {
    if (((s_33557273[(i_33557278 + 2)] == 70) || (s_33557273[(i_33557278 + 2)] == 102))) {
    if (!((ConstSet6[s_33557273[(i_33557278 + 3)]] != undefined))) {
    if (sign_33557277) {
    Temporary1 = -Infinity;
    }
    else {
    Temporary1 = Infinity;
    }
    
    number_33557274[number_33557274_Idx] = Temporary1;
    result_33557276 = ((i_33557278 + 3) - start_33557275);
    break BeforeRet;
    }
    
    }
    
    }
    
    result_33557276 = 0;
    break BeforeRet;
    }
    
    var buf_33557295 = [];
    if (sign_33557277) {
    addChar(buf_33557295, 45);;
    }
    
    Label2: do {
        Label3: while (true) {
        if (!(ConstSet7[s_33557273[i_33557278]] != undefined)) break Label3;
          addChar(buf_33557295, s_33557273[i_33557278]);;
          i_33557278 += 1;
          Label4: do {
              Label5: while (true) {
              if (!(s_33557273[i_33557278] == 95)) break Label5;
                i_33557278 += 1;
              }
          } while (false);
        }
    } while (false);
    if ((s_33557273[i_33557278] == 46)) {
    addChar(buf_33557295, s_33557273[i_33557278]);;
    i_33557278 += 1;
    Label6: do {
        Label7: while (true) {
        if (!(ConstSet8[s_33557273[i_33557278]] != undefined)) break Label7;
          addChar(buf_33557295, s_33557273[i_33557278]);;
          i_33557278 += 1;
          Label8: do {
              Label9: while (true) {
              if (!(s_33557273[i_33557278] == 95)) break Label9;
                i_33557278 += 1;
              }
          } while (false);
        }
    } while (false);
    }
    
    if (((buf_33557295).length == (sign_33557277 ? 1 : 0))) {
    result_33557276 = 0;
    break BeforeRet;
    }
    
    if ((ConstSet9[s_33557273[i_33557278]] != undefined)) {
    addChar(buf_33557295, s_33557273[i_33557278]);;
    i_33557278 += 1;
    if ((s_33557273[i_33557278] == 43)) {
    i_33557278 += 1;
    }
    else {
    if ((s_33557273[i_33557278] == 45)) {
    addChar(buf_33557295, s_33557273[i_33557278]);;
    i_33557278 += 1;
    }
    }
    if (!((ConstSet10[s_33557273[i_33557278]] != undefined))) {
    result_33557276 = 0;
    break BeforeRet;
    }
    
    Label10: do {
        Label11: while (true) {
        if (!(ConstSet11[s_33557273[i_33557278]] != undefined)) break Label11;
          addChar(buf_33557295, s_33557273[i_33557278]);;
          i_33557278 += 1;
          Label12: do {
              Label13: while (true) {
              if (!(s_33557273[i_33557278] == 95)) break Label13;
                i_33557278 += 1;
              }
          } while (false);
        }
    } while (false);
    }
    
    number_33557274[number_33557274_Idx] = parseFloatNative_33557268(buf_33557295);
    result_33557276 = (i_33557278 - start_33557275);
  } while (false);

  return result_33557276;

}
var ConstSet12 = setConstr([48, 57]);
var ConstSet13 = setConstr([48, 57]);

function cstrToNimstr(c_33556804) {
      var ln = c_33556804.length;
  var result = new Array(ln);
  var r = 0;
  for (var i = 0; i < ln; ++i) {
    var ch = c_33556804.charCodeAt(i);

    if (ch < 128) {
      result[r] = ch;
    }
    else {
      if (ch < 2048) {
        result[r] = (ch >> 6) | 192;
      }
      else {
        if (ch < 55296 || ch >= 57344) {
          result[r] = (ch >> 12) | 224;
        }
        else {
            ++i;
            ch = 65536 + (((ch & 1023) << 10) | (c_33556804.charCodeAt(i) & 1023));
            result[r] = (ch >> 18) | 240;
            ++r;
            result[r] = ((ch >> 12) & 63) | 128;
        }
        ++r;
        result[r] = ((ch >> 6) & 63) | 128;
      }
      ++r;
      result[r] = (ch & 63) | 128;
    }
    ++r;
  }
  return result;
  

  
}
if (!Math.trunc) {
  Math.trunc = function(v) {
    v = +v;
    if (!isFinite(v)) return v;
    return (v - v % 1) || (v < 0 ? -0 : v === 0 ? v : 0);
  };
}

var objectID_738197666 = [0];

function length_1157627944(v_1157627945) {
  var result_1157627946 = 0.0;

    result_1157627946 = Math.sqrt((((v_1157627945.x * v_1157627945.x) + (v_1157627945.y * v_1157627945.y)) + (v_1157627945.z * v_1157627945.z)));

  return result_1157627946;

}

function isFatPointer_33557131(ti_33557132) {
  var result_33557133 = false;

  BeforeRet: do {
    result_33557133 = !((ConstSet1[ti_33557132.base.kind] != undefined));
    break BeforeRet;
  } while (false);

  return result_33557133;

}

function nimCopyAux(dest_33557144, src_33557145, n_33557146) {
    switch (n_33557146.kind) {
    case 0:
      break;
    case 1:
            dest_33557144[n_33557146.offset] = nimCopy(dest_33557144[n_33557146.offset], src_33557145[n_33557146.offset], n_33557146.typ);
    
      break;
    case 2:
          for (var i = 0; i < n_33557146.sons.length; i++) {
      nimCopyAux(dest_33557144, src_33557145, n_33557146.sons[i]);
    }
    
      break;
    case 3:
            dest_33557144[n_33557146.offset] = nimCopy(dest_33557144[n_33557146.offset], src_33557145[n_33557146.offset], n_33557146.typ);
      for (var i = 0; i < n_33557146.sons.length; ++i) {
        nimCopyAux(dest_33557144, src_33557145, n_33557146.sons[i][1]);
      }
    
      break;
    }

  
}

function vec3_1157627910(x_1157627911, y_1157627912, z_1157627913) {
  var result_1157627914 = ({x: 0.0, y: 0.0, z: 0.0});

    result_1157627914 = nimCopy(result_1157627914, {x: x_1157627911, y: y_1157627912, z: z_1157627913}, NTI1157627907);

  return result_1157627914;

}

function normalize_1157627947(v_1157627948) {
    var Temporary1;

  var result_1157627949 = ({x: 0.0, y: 0.0, z: 0.0});

    var len_1157627950 = length_1157627944(v_1157627948);
    if ((0.0 < len_1157627950)) {
    Temporary1 = vec3_1157627910((v_1157627948.x / len_1157627950), (v_1157627948.y / len_1157627950), (v_1157627948.z / len_1157627950));
    }
    else {
    Temporary1 = v_1157627948;
    }
    
    result_1157627949 = nimCopy(result_1157627949, Temporary1, NTI1157627907);

  return result_1157627949;

}
var renderer_469762103 = [null];
var lightDir_469762106 = normalize_1157627947(vec3_1157627910(0.0, 0.5, -1.0));

function HEX2BHEX3D_989857831(x_989857833, x_989857833_Idx, y_989857834) {
    x_989857833[x_989857833_Idx] = (x_989857833[x_989857833_Idx] + y_989857834);

  
}

function clear_469762116(r_469762117) {
        const p = r_469762117.pixels;
    const len = p.length;
    for(let i=0; i<len; i+=4) { p[i]=20; p[i+1]=20; p[i+2]=30; p[i+3]=255; }
  

  
}

function add_33556419(x_33556420, x_33556420_Idx, y_33556421) {
          if (x_33556420[x_33556420_Idx] === null) { x_33556420[x_33556420_Idx] = []; }
      var off = x_33556420[x_33556420_Idx].length;
      x_33556420[x_33556420_Idx].length += y_33556421.length;
      for (var i = 0; i < y_33556421.length; ++i) {
        x_33556420[x_33556420_Idx][off+i] = y_33556421.charCodeAt(i);
      }
    

  
}

function newSeq_33556825(len_33556827) {
  var result_33556828 = [];

    result_33556828 = new Array(len_33556827); for (var i = 0 ; i < len_33556827 ; ++i) { result_33556828[i] = null; }
  return result_33556828;

}

function unhandledException(e_33556663) {
    var buf_33556664 = [[]];
    if (!(((e_33556663.message).length == 0))) {
    buf_33556664[0].push.apply(buf_33556664[0], makeNimstrLit("Error: unhandled exception: "));;
    buf_33556664[0].push.apply(buf_33556664[0], e_33556663.message);;
    }
    else {
    buf_33556664[0].push.apply(buf_33556664[0], makeNimstrLit("Error: unhandled exception"));;
    }
    
    buf_33556664[0].push.apply(buf_33556664[0], makeNimstrLit(" ["));;
    add_33556419(buf_33556664, 0, e_33556663.name);
    buf_33556664[0].push.apply(buf_33556664[0], makeNimstrLit("]\x0A"));;
    var cbuf_33556665 = toJSStr(buf_33556664[0]);
      if (typeof(Error) !== "undefined") {
    throw new Error(cbuf_33556665);
  }
  else {
    throw cbuf_33556665;
  }
  

  
}

function raiseOverflow() {
    raiseException({message: makeNimstrLit("over- or underflow"), parent: null, m_type: NTI33555122, name: null, trace: [], up: null}, "OverflowDefect");

  
}

function checkOverflowInt(a_33556938) {
        if (a_33556938 > 2147483647 || a_33556938 < -2147483648) raiseOverflow();
  

  
}

function raiseRangeError() {
    raiseException({message: makeNimstrLit("value out of range"), parent: null, m_type: NTI33555130, name: null, trace: [], up: null}, "RangeDefect");

  
}

function addChars_251658415(result_251658417, result_251658417_Idx, x_251658418, start_251658419, n_251658420) {
    var old_251658421 = (result_251658417[result_251658417_Idx]).length;
    (result_251658417[result_251658417_Idx].length = chckRange(addInt(old_251658421, n_251658420), 0, 2147483647));
    Label1: do {
      var iHEX60gensym4_251658435 = 0;
      var i_469763046 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(i_469763046 < n_251658420)) break Label3;
            iHEX60gensym4_251658435 = i_469763046;
            result_251658417[result_251658417_Idx][chckIndx(addInt(old_251658421, iHEX60gensym4_251658435), 0, (result_251658417[result_251658417_Idx]).length - 1)] = x_251658418.charCodeAt(chckIndx(addInt(start_251658419, iHEX60gensym4_251658435), 0, (x_251658418).length - 1));
            i_469763046 = addInt(i_469763046, 1);
          }
      } while (false);
    } while (false);

  
}

function addChars_251658411(result_251658413, result_251658413_Idx, x_251658414) {
    addChars_251658415(result_251658413, result_251658413_Idx, x_251658414, 0, ((x_251658414) == null ? 0 : (x_251658414).length));

  
}

function addInt_251658436(result_251658437, result_251658437_Idx, x_251658438) {
    addChars_251658411(result_251658437, result_251658437_Idx, ((x_251658438) + ""));

  
}

function addInt_251658457(result_251658458, result_251658458_Idx, x_251658459) {
    addInt_251658436(result_251658458, result_251658458_Idx, x_251658459);

  
}

function HEX24_335544323(x_335544324) {
  var result_335544325 = [[]];

    addInt_251658457(result_335544325, 0, x_335544324);

  return result_335544325[0];

}

function raiseIndexError(i_33556754, a_33556755, b_33556756) {
    var Temporary1;

    if ((b_33556756 < a_33556755)) {
    Temporary1 = makeNimstrLit("index out of bounds, the container is empty");
    }
    else {
    Temporary1 = (makeNimstrLit("index ") || []).concat(HEX24_335544323(i_33556754) || [],makeNimstrLit(" not in ") || [],HEX24_335544323(a_33556755) || [],makeNimstrLit(" .. ") || [],HEX24_335544323(b_33556756) || []);
    }
    
    raiseException({message: nimCopy(null, Temporary1, NTI33554439), parent: null, m_type: NTI33555128, name: null, trace: [], up: null}, "IndexDefect");

  
}

function HEX2D_1157627928(a_1157627929, b_1157627930) {
  var result_1157627931 = ({x: 0.0, y: 0.0, z: 0.0});

    result_1157627931 = nimCopy(result_1157627931, vec3_1157627910((a_1157627929.x - b_1157627930.x), (a_1157627929.y - b_1157627930.y), (a_1157627929.z - b_1157627930.z)), NTI1157627907);

  return result_1157627931;

}

function cross_1157627940(a_1157627941, b_1157627942) {
  var result_1157627943 = ({x: 0.0, y: 0.0, z: 0.0});

    result_1157627943 = nimCopy(result_1157627943, vec3_1157627910(((a_1157627941.y * b_1157627942.z) - (a_1157627941.z * b_1157627942.y)), ((a_1157627941.z * b_1157627942.x) - (a_1157627941.x * b_1157627942.z)), ((a_1157627941.x * b_1157627942.y) - (a_1157627941.y * b_1157627942.x))), NTI1157627907);

  return result_1157627943;

}

function max_33556208(x_33556209, y_33556210) {
    var Temporary1;
      var Temporary2;

  var result_33556211 = 0.0;

      if ((y_33556210 <= x_33556209)) Temporary2 = true; else {        Temporary2 = !((y_33556210 == y_33556210));      }    if (Temporary2) {
    Temporary1 = x_33556209;
    }
    else {
    Temporary1 = y_33556210;
    }
    
    result_33556211 = Temporary1;

  return result_33556211;

}

function dot_1157627936(a_1157627937, b_1157627938) {
  var result_1157627939 = 0.0;

    result_1157627939 = (((a_1157627937.x * b_1157627938.x) + (a_1157627937.y * b_1157627938.y)) + (a_1157627937.z * b_1157627938.z));

  return result_1157627939;

}

function projectRotated_469762272(r_469762273, rotated_469762274) {
  var result_469762278 = {Field0: 0, Field1: 0, Field2: 0.0};

    var z_469762280 = (rotated_469762274.z + 3.0);
    var scale_469762281 = (2.0 / max_33556208(z_469762280, 0.1));
    var halfW_469762282 = (r_469762273.width * 0.5);
    var halfH_469762283 = (r_469762273.height * 0.5);
    result_469762278 = nimCopy(result_469762278, {Field0: (((((rotated_469762274.x * scale_469762281) + 1.0) * halfW_469762282)) | 0), Field1: (((((rotated_469762274.y * scale_469762281) + 1.0) * halfH_469762283)) | 0), Field2: rotated_469762274.z}, NTI469762165);

  return result_469762278;

}

function isInsideFrustum_469762296(r_469762297, p_469762301) {
    var Temporary1;
    var Temporary2;
    var Temporary3;
    var Temporary4;

  var result_469762302 = false;

    var margin_469762303 = 50;
    if (!(negInt(margin_469762303) <= p_469762301.Field0)) Temporary4 = false; else {      Temporary4 = (p_469762301.Field0 < addInt(r_469762297.width, margin_469762303));    }    if (!Temporary4) Temporary3 = false; else {      Temporary3 = (negInt(margin_469762303) <= p_469762301.Field1);    }    if (!Temporary3) Temporary2 = false; else {      Temporary2 = (p_469762301.Field1 < addInt(r_469762297.height, margin_469762303));    }    if (!Temporary2) Temporary1 = false; else {      Temporary1 = (-10.0 < p_469762301.Field2);    }    result_469762302 = Temporary1;

  return result_469762302;

}

function triangleVisible_469762304(r_469762305, p0_469762309, p1_469762310, p2_469762311) {
  var result_469762312 = false;

    result_469762312 = ((isInsideFrustum_469762296(r_469762305, p0_469762309) || isInsideFrustum_469762296(r_469762305, p1_469762310)) || isInsideFrustum_469762296(r_469762305, p2_469762311));

  return result_469762312;

}

function sysFatal_218103842(message_218103845) {
    raiseException({message: nimCopy(null, message_218103845, NTI33554439), m_type: NTI33555124, parent: null, name: null, trace: [], up: null}, "AssertionDefect");

  
}

function raiseAssert_218103840(msg_218103841) {
    sysFatal_218103842(msg_218103841);

  
}

function failedAssertImpl_218103864(msg_218103865) {
    raiseAssert_218103840(msg_218103865);

  
}

function newSeq_469762461(len_469762463) {
  var result_469762464 = [];

    result_469762464 = new Array(len_469762463); for (var i = 0 ; i < len_469762463 ; ++i) { result_469762464[i] = {Field0: 0.0, Field1: 0.0, Field2: {Field0: 0, Field1: 0, Field2: 0.0}, Field3: {Field0: 0, Field1: 0, Field2: 0.0}, Field4: {Field0: 0, Field1: 0, Field2: 0.0}, Field5: {Field0: 0.0, Field1: 0.0}, Field6: {Field0: 0.0, Field1: 0.0}, Field7: {Field0: 0.0, Field1: 0.0}}; }
  return result_469762464;

}

function raiseDivByZero() {
    raiseException({message: makeNimstrLit("division by zero"), parent: null, m_type: NTI33555121, name: null, trace: [], up: null}, "DivByZeroDefect");

  
}

function HEX2A_922746888(x_922746889, order_922746890) {
  var result_922746891 = 0;

    var y_922746896 = subInt(order_922746890, 1);
    result_922746891 = subInt((x_922746889 ^ y_922746896), y_922746896);

  return result_922746891;

}

function mergeAlt_469762490(a_469762492, b_469762493, lo_469762494, m_469762495, hi_469762496, cmp_469762499, order_469762500) {
  BeforeRet: do {
    if ((HEX2A_922746888(cmp_469762499(a_469762492[chckIndx(m_469762495, 0, (a_469762492).length - 1)], a_469762492[chckIndx(addInt(m_469762495, 1), 0, (a_469762492).length - 1)]), order_469762500) <= 0)) {
    break BeforeRet;
    }
    
    var j_469762501 = lo_469762494;
    if (!((j_469762501 <= m_469762495))) {
    failedAssertImpl_218103864(makeNimstrLit("algorithm.nim(334, 10) `j <= m` "));
    }
    
    var bb_469762507 = 0;
    Label1: do {
        Label2: while (true) {
        if (!(j_469762501 <= m_469762495)) break Label2;
          b_469762493[chckIndx(bb_469762507, 0, (b_469762493).length - 1)] = nimCopy(b_469762493[chckIndx(bb_469762507, 0, (b_469762493).length - 1)], a_469762492[chckIndx(j_469762501, 0, (a_469762492).length - 1)], NTI469762180);
          bb_469762507 = addInt(bb_469762507, 1);
          j_469762501 = addInt(j_469762501, 1);
        }
    } while (false);
    var i_469762516 = 0;
    var k_469762517 = lo_469762494;
    Label3: do {
        Label4: while (true) {
        if (!((k_469762517 < j_469762501) && (j_469762501 <= hi_469762496))) break Label4;
          if ((HEX2A_922746888(cmp_469762499(b_469762493[chckIndx(i_469762516, 0, (b_469762493).length - 1)], a_469762492[chckIndx(j_469762501, 0, (a_469762492).length - 1)]), order_469762500) <= 0)) {
          a_469762492[chckIndx(k_469762517, 0, (a_469762492).length - 1)] = nimCopy(a_469762492[chckIndx(k_469762517, 0, (a_469762492).length - 1)], b_469762493[chckIndx(i_469762516, 0, (b_469762493).length - 1)], NTI469762180);
          i_469762516 = addInt(i_469762516, 1);
          }
          else {
            a_469762492[chckIndx(k_469762517, 0, (a_469762492).length - 1)] = nimCopy(a_469762492[chckIndx(k_469762517, 0, (a_469762492).length - 1)], a_469762492[chckIndx(j_469762501, 0, (a_469762492).length - 1)], NTI469762180);
            j_469762501 = addInt(j_469762501, 1);
          }
          
          k_469762517 = addInt(k_469762517, 1);
        }
    } while (false);
    Label5: do {
        Label6: while (true) {
        if (!(k_469762517 < j_469762501)) break Label6;
          a_469762492[chckIndx(k_469762517, 0, (a_469762492).length - 1)] = nimCopy(a_469762492[chckIndx(k_469762517, 0, (a_469762492).length - 1)], b_469762493[chckIndx(i_469762516, 0, (b_469762493).length - 1)], NTI469762180);
          k_469762517 = addInt(k_469762517, 1);
          i_469762516 = addInt(i_469762516, 1);
        }
    } while (false);
  } while (false);

  
}

function sort_469762449(a_469762451, cmp_469762454, order_469762455) {
    var n_469762460 = (a_469762451).length;
    var b_469762487 = newSeq_469762461(chckRange(divInt(n_469762460, 2), 0, 2147483647));
    var s_469762488 = 1;
    Label1: do {
        Label2: while (true) {
        if (!(s_469762488 < n_469762460)) break Label2;
          var m_469762489 = subInt(subInt(n_469762460, 1), s_469762488);
          Label3: do {
              Label4: while (true) {
              if (!(0 <= m_469762489)) break Label4;
                mergeAlt_469762490(a_469762451, b_469762487, nimMax(addInt(subInt(m_469762489, s_469762488), 1), 0), m_469762489, addInt(m_469762489, s_469762488), cmp_469762454, order_469762455);
                m_469762489 = subInt(m_469762489, mulInt(s_469762488, 2));
              }
          } while (false);
          s_469762488 = mulInt(s_469762488, 2);
        }
    } while (false);

  
}

function cmp_469762440(x_469762442, y_469762443) {
  var result_469762444 = 0;

  BeforeRet: do {
    if ((x_469762442 == y_469762443)) {
    result_469762444 = 0;
    break BeforeRet;
    }
    
    if ((x_469762442 < y_469762443)) {
    result_469762444 = -1;
    break BeforeRet;
    }
    
    result_469762444 = 1;
    break BeforeRet;
  } while (false);

  return result_469762444;

}

function clamp_469762242(x_469762244, a_469762245, b_469762246) {
  var result_469762247 = 0.0;

  BeforeRet: do {
    if ((x_469762244 < a_469762245)) {
    result_469762247 = a_469762245;
    break BeforeRet;
    }
    
    if ((b_469762246 < x_469762244)) {
    result_469762247 = b_469762246;
    break BeforeRet;
    }
    
    result_469762247 = x_469762244;
    break BeforeRet;
  } while (false);

  return result_469762247;

}

function drawTexturedTriangle_469762118(r_469762119, x0_469762120, y0_469762121, u0_469762122, v0_469762123, x1_469762124, y1_469762125, u1_469762126, v1_469762127, x2_469762128, y2_469762129, u2_469762130, v2_469762131, intensity_469762132) {
              var Temporary17;
              var Temporary18;
              var Temporary19;
                var Temporary23;
              var Temporary24;

  BeforeRet: do {
    var py0_469762133 = y0_469762121;
    var py1_469762134 = y0_469762121;
    var py2_469762135 = y0_469762121;
    var px0_469762136 = x0_469762120;
    var px1_469762137 = x0_469762120;
    var px2_469762138 = x0_469762120;
    var pu0_469762139 = u0_469762122;
    var pu1_469762140 = u0_469762122;
    var pu2_469762141 = u0_469762122;
    var pv0_469762142 = v0_469762123;
    var pv1_469762143 = v0_469762123;
    var pv2_469762144 = v0_469762123;
    py1_469762134 = y1_469762125;
    px1_469762137 = x1_469762124;
    pu1_469762140 = u1_469762126;
    pv1_469762143 = v1_469762127;
    py2_469762135 = y2_469762129;
    px2_469762138 = x2_469762128;
    pu2_469762141 = u2_469762130;
    pv2_469762144 = v2_469762131;
    if ((py1_469762134 < py0_469762133)) {
    var Temporary1 = py0_469762133; py0_469762133 = py1_469762134; py1_469762134 = Temporary1;    var Temporary2 = px0_469762136; px0_469762136 = px1_469762137; px1_469762137 = Temporary2;    var Temporary3 = pu0_469762139; pu0_469762139 = pu1_469762140; pu1_469762140 = Temporary3;    var Temporary4 = pv0_469762142; pv0_469762142 = pv1_469762143; pv1_469762143 = Temporary4;    }
    
    if ((py2_469762135 < py0_469762133)) {
    var Temporary5 = py0_469762133; py0_469762133 = py2_469762135; py2_469762135 = Temporary5;    var Temporary6 = px0_469762136; px0_469762136 = px2_469762138; px2_469762138 = Temporary6;    var Temporary7 = pu0_469762139; pu0_469762139 = pu2_469762141; pu2_469762141 = Temporary7;    var Temporary8 = pv0_469762142; pv0_469762142 = pv2_469762144; pv2_469762144 = Temporary8;    }
    
    if ((py2_469762135 < py1_469762134)) {
    var Temporary9 = py1_469762134; py1_469762134 = py2_469762135; py2_469762135 = Temporary9;    var Temporary10 = px1_469762137; px1_469762137 = px2_469762138; px2_469762138 = Temporary10;    var Temporary11 = pu1_469762140; pu1_469762140 = pu2_469762141; pu2_469762141 = Temporary11;    var Temporary12 = pv1_469762143; pv1_469762143 = pv2_469762144; pv2_469762144 = Temporary12;    }
    
    var totalHeight_469762193 = subInt(py2_469762135, py0_469762133);
    if ((totalHeight_469762193 == 0)) {
    break BeforeRet;
    }
    
    var width_469762194 = r_469762119.width;
    var height_469762195 = r_469762119.height;
    var tex_469762196 = r_469762119.texture;
    var texW_469762197 = subInt(tex_469762196.width, 1);
    var texH_469762198 = subInt(tex_469762196.height, 1);
    var texWidth_469762199 = tex_469762196.width;
    Label13: do {
      var i_469762204 = 0;
      var i_469763060 = 0;
      Label14: do {
          Label15: while (true) {
          if (!(i_469763060 < totalHeight_469762193)) break Label15;
            i_469762204 = i_469763060;
            Label16: do {
              if ((subInt(py1_469762134, py0_469762133) < i_469762204)) Temporary17 = true; else {                Temporary17 = (py1_469762134 == py0_469762133);              }              var secondHalf_469762205 = Temporary17;
              if (secondHalf_469762205) {
              Temporary18 = subInt(py2_469762135, py1_469762134);
              }
              else {
              Temporary18 = subInt(py1_469762134, py0_469762133);
              }
              
              var segmentHeight_469762206 = Temporary18;
              if ((segmentHeight_469762206 == 0)) {
              break Label16;
              }
              
              var alpha_469762207 = (i_469762204 / totalHeight_469762193);
              if (secondHalf_469762205) {
              Temporary19 = (subInt(i_469762204, subInt(py1_469762134, py0_469762133)) / segmentHeight_469762206);
              }
              else {
              Temporary19 = (i_469762204 / segmentHeight_469762206);
              }
              
              var beta_469762208 = Temporary19;
              var ax_469762209 = (px0_469762136 + (subInt(px2_469762138, px0_469762136) * alpha_469762207));
              var au_469762210 = (pu0_469762139 + ((pu2_469762141 - pu0_469762139) * alpha_469762207));
              var av_469762211 = (pv0_469762142 + ((pv2_469762144 - pv0_469762142) * alpha_469762207));
              var bx_469762212 = 0.0;
              var bu_469762213 = 0.0;
              var bv_469762214 = 0.0;
              if (secondHalf_469762205) {
              bx_469762212 = (px1_469762137 + (subInt(px2_469762138, px1_469762137) * beta_469762208));
              bu_469762213 = (pu1_469762140 + ((pu2_469762141 - pu1_469762140) * beta_469762208));
              bv_469762214 = (pv1_469762143 + ((pv2_469762144 - pv1_469762143) * beta_469762208));
              }
              else {
                bx_469762212 = (px0_469762136 + (subInt(px1_469762137, px0_469762136) * beta_469762208));
                bu_469762213 = (pu0_469762139 + ((pu1_469762140 - pu0_469762139) * beta_469762208));
                bv_469762214 = (pv0_469762142 + ((pv1_469762143 - pv0_469762142) * beta_469762208));
              }
              
              if ((bx_469762212 < ax_469762209)) {
              var Temporary20 = ax_469762209; ax_469762209 = bx_469762212; bx_469762212 = Temporary20;              var Temporary21 = au_469762210; au_469762210 = bu_469762213; bu_469762213 = Temporary21;              var Temporary22 = av_469762211; av_469762211 = bv_469762214; bv_469762214 = Temporary22;              }
              
              var y_469762227 = addInt(py0_469762133, i_469762204);
                if ((y_469762227 < 0)) Temporary23 = true; else {                  Temporary23 = (height_469762195 <= y_469762227);                }              if (Temporary23) {
              break Label16;
              }
              
              var iax_469762228 = nimMax(0, ((ax_469762209) | 0));
              var ibx_469762229 = nimMin(subInt(width_469762194, 1), ((bx_469762212) | 0));
              if ((ibx_469762229 < iax_469762228)) {
              break Label16;
              }
              
              var spanWidth_469762230 = (bx_469762212 - ax_469762209);
              if ((0.001 < spanWidth_469762230)) {
              Temporary24 = (1.0 / spanWidth_469762230);
              }
              else {
              Temporary24 = 0.0;
              }
              
              var invSpan_469762231 = Temporary24;
              var flippedY_469762232 = subInt(subInt(height_469762195, 1), y_469762227);
              var baseIdx_469762233 = mulInt(addInt(mulInt(flippedY_469762232, width_469762194), iax_469762228), 4);
              Label25: do {
                var x_469762238 = 0;
                var res_469763058 = iax_469762228;
                Label26: do {
                    Label27: while (true) {
                    if (!(res_469763058 <= ibx_469762229)) break Label27;
                      x_469762238 = res_469763058;
                      var t_469762239 = ((x_469762238 - ax_469762209) * invSpan_469762231);
                      var u_469762240 = (au_469762210 + ((bu_469762213 - au_469762210) * t_469762239));
                      var v_469762241 = (av_469762211 + ((bv_469762214 - av_469762211) * t_469762239));
                      var tpx_469762248 = (((clamp_469762242(u_469762240, 0.0, 1.0) * texW_469762197)) | 0);
                      var tpy_469762254 = ((((1.0 - clamp_469762242(v_469762241, 0.0, 1.0)) * texH_469762198)) | 0);
                      var tidx_469762255 = mulInt(addInt(mulInt(tpy_469762254, texWidth_469762199), tpx_469762248), 4);
                      var tr_469762256 = 0;
                      var tg_469762257 = 0;
                      var tb_469762258 = 0;
                      var td=tex_469762196.jsData.data;tr_469762256=td[tidx_469762255];tg_469762257=td[tidx_469762255+1];tb_469762258=td[tidx_469762255+2];
                      r_469762119.pixels[baseIdx_469762233]=tr_469762256*intensity_469762132|0;
                      r_469762119.pixels[baseIdx_469762233+1]=tg_469762257*intensity_469762132|0;
                      r_469762119.pixels[baseIdx_469762233+2]=tb_469762258*intensity_469762132|0;
                      r_469762119.pixels[baseIdx_469762233+3]=255;
                      baseIdx_469762233 = addInt(baseIdx_469762233, 4);
                      res_469763058 = addInt(res_469763058, 1);
                    }
                } while (false);
              } while (false);
            } while (false);
            i_469763060 = addInt(i_469763060, 1);
          }
      } while (false);
    } while (false);
  } while (false);

  
}

function drawModel_469762313(r_469762314) {
                var Temporary5;
                var Temporary6;
    
function HEX3Aanonymous_469762436(a_469762437, b_469762438) {
      var result_469762439 = 0;

        result_469762439 = cmp_469762440(b_469762438.Field0, a_469762437.Field0);

      return result_469762439;

    }

    var visibleFaces_469762342 = [];
    var cosY_469762346 = Math.cos(r_469762314.rotationY);
    var sinY_469762350 = Math.sin(r_469762314.rotationY);
    var cosX_469762354 = Math.cos(r_469762314.rotationX);
    var sinX_469762358 = Math.sin(r_469762314.rotationX);
    var hasTexCoords_469762369 = (0 < (r_469762314.model.texCoords).length);
    Label1: do {
      var face_469762391 = ({v: new Int32Array(3), t: new Int32Array(3)});
      var i_469763034 = 0;
      var L_469763035 = (r_469762314.model.faces).length;
      Label2: do {
          Label3: while (true) {
          if (!(i_469763034 < L_469763035)) break Label3;
            face_469762391 = r_469762314.model.faces[chckIndx(i_469763034, 0, (r_469762314.model.faces).length - 1)];
            Label4: do {
              var v0_469762392 = nimCopy(null, r_469762314.model.vertices[chckIndx(face_469762391.v[chckIndx(0, 0, (face_469762391.v).length - 1)], 0, (r_469762314.model.vertices).length - 1)], NTI1157627907);
              var v1_469762393 = nimCopy(null, r_469762314.model.vertices[chckIndx(face_469762391.v[chckIndx(1, 0, (face_469762391.v).length - 1)], 0, (r_469762314.model.vertices).length - 1)], NTI1157627907);
              var v2_469762394 = nimCopy(null, r_469762314.model.vertices[chckIndx(face_469762391.v[chckIndx(2, 0, (face_469762391.v).length - 1)], 0, (r_469762314.model.vertices).length - 1)], NTI1157627907);
              var ryHEX60gensym14_469762396 = vec3_1157627910(((v0_469762392.x * cosY_469762346) + (v0_469762392.z * sinY_469762350)), v0_469762392.y, ((-(v0_469762392.x) * sinY_469762350) + (v0_469762392.z * cosY_469762346)));
              var rv0_469762397 = nimCopy(null, vec3_1157627910(ryHEX60gensym14_469762396.x, ((ryHEX60gensym14_469762396.y * cosX_469762354) - (ryHEX60gensym14_469762396.z * sinX_469762358)), ((ryHEX60gensym14_469762396.y * sinX_469762358) + (ryHEX60gensym14_469762396.z * cosX_469762354))), NTI1157627907);
              var ryHEX60gensym15_469762399 = vec3_1157627910(((v1_469762393.x * cosY_469762346) + (v1_469762393.z * sinY_469762350)), v1_469762393.y, ((-(v1_469762393.x) * sinY_469762350) + (v1_469762393.z * cosY_469762346)));
              var rv1_469762400 = nimCopy(null, vec3_1157627910(ryHEX60gensym15_469762399.x, ((ryHEX60gensym15_469762399.y * cosX_469762354) - (ryHEX60gensym15_469762399.z * sinX_469762358)), ((ryHEX60gensym15_469762399.y * sinX_469762358) + (ryHEX60gensym15_469762399.z * cosX_469762354))), NTI1157627907);
              var ryHEX60gensym16_469762402 = vec3_1157627910(((v2_469762394.x * cosY_469762346) + (v2_469762394.z * sinY_469762350)), v2_469762394.y, ((-(v2_469762394.x) * sinY_469762350) + (v2_469762394.z * cosY_469762346)));
              var rv2_469762403 = nimCopy(null, vec3_1157627910(ryHEX60gensym16_469762402.x, ((ryHEX60gensym16_469762402.y * cosX_469762354) - (ryHEX60gensym16_469762402.z * sinX_469762358)), ((ryHEX60gensym16_469762402.y * sinX_469762358) + (ryHEX60gensym16_469762402.z * cosX_469762354))), NTI1157627907);
              var edge1_469762404 = HEX2D_1157627928(rv1_469762400, rv0_469762397);
              var edge2_469762405 = HEX2D_1157627928(rv2_469762403, rv0_469762397);
              var normal_469762406 = normalize_1157627947(cross_1157627940(edge1_469762404, edge2_469762405));
              if ((0.0 < normal_469762406.z)) {
              break Label4;
              }
              
              var intensity_469762407 = max_33556208(0.2, dot_1157627936(normal_469762406, lightDir_469762106));
              var p0_469762408 = projectRotated_469762272(r_469762314, rv0_469762397);
              var p1_469762409 = projectRotated_469762272(r_469762314, rv1_469762400);
              var p2_469762410 = projectRotated_469762272(r_469762314, rv2_469762403);
              if (!(triangleVisible_469762304(r_469762314, p0_469762408, p1_469762409, p2_469762410))) {
              break Label4;
              }
              
              var uv0_469762411 = {Field0: 0.0, Field1: 0.0};
              var uv1_469762412 = {Field0: 0.0, Field1: 0.0};
              var uv2_469762413 = {Field0: 0.0, Field1: 0.0};
                if (!hasTexCoords_469762369) Temporary6 = false; else {                  Temporary6 = (0 <= face_469762391.t[chckIndx(0, 0, (face_469762391.t).length - 1)]);                }                if (!Temporary6) Temporary5 = false; else {                  Temporary5 = (face_469762391.t[chckIndx(0, 0, (face_469762391.t).length - 1)] < (r_469762314.model.texCoords).length);                }              if (Temporary5) {
              uv0_469762411 = nimCopy(uv0_469762411, r_469762314.model.texCoords[chckIndx(face_469762391.t[chckIndx(0, 0, (face_469762391.t).length - 1)], 0, (r_469762314.model.texCoords).length - 1)], NTI469762071);
              uv1_469762412 = nimCopy(uv1_469762412, r_469762314.model.texCoords[chckIndx(face_469762391.t[chckIndx(1, 0, (face_469762391.t).length - 1)], 0, (r_469762314.model.texCoords).length - 1)], NTI469762071);
              uv2_469762413 = nimCopy(uv2_469762413, r_469762314.model.texCoords[chckIndx(face_469762391.t[chckIndx(2, 0, (face_469762391.t).length - 1)], 0, (r_469762314.model.texCoords).length - 1)], NTI469762071);
              }
              else {
                var colontmp__469763027 = 0.0;
                var colontmp__469763028 = 0.0;
                uv0_469762411 = nimCopy(uv0_469762411, {Field0: colontmp__469763027, Field1: colontmp__469763028}, NTI469762071);
                var colontmp__469763029 = 1.0;
                var colontmp__469763030 = 0.0;
                uv1_469762412 = nimCopy(uv1_469762412, {Field0: colontmp__469763029, Field1: colontmp__469763030}, NTI469762071);
                var colontmp__469763031 = 0.5;
                var colontmp__469763032 = 1.0;
                uv2_469762413 = nimCopy(uv2_469762413, {Field0: colontmp__469763031, Field1: colontmp__469763032}, NTI469762071);
              }
              
              var avgDepth_469762423 = (((rv0_469762397.z + rv1_469762400.z) + rv2_469762403.z) * 0.333333);
              visibleFaces_469762342.push({Field0: avgDepth_469762423, Field1: intensity_469762407, Field2: nimCopy(null, p0_469762408, NTI469762181), Field3: nimCopy(null, p1_469762409, NTI469762181), Field4: nimCopy(null, p2_469762410, NTI469762181), Field5: nimCopy(null, uv0_469762411, NTI469762071), Field6: nimCopy(null, uv1_469762412, NTI469762071), Field7: nimCopy(null, uv2_469762413, NTI469762071)});;
            } while (false);
            i_469763034 = addInt(i_469763034, 1);
            if (!(((r_469762314.model.faces).length == L_469763035))) {
            failedAssertImpl_218103864(makeNimstrLit("iterators.nim(240, 11) `len(a) == L` the length of the seq changed while iterating over it"));
            }
            
          }
      } while (false);
    } while (false);
    sort_469762449(visibleFaces_469762342, HEX3Aanonymous_469762436, 1);
    Label7: do {
      var fd_469762572 = {Field0: 0.0, Field1: 0.0, Field2: {Field0: 0, Field1: 0, Field2: 0.0}, Field3: {Field0: 0, Field1: 0, Field2: 0.0}, Field4: {Field0: 0, Field1: 0, Field2: 0.0}, Field5: {Field0: 0.0, Field1: 0.0}, Field6: {Field0: 0.0, Field1: 0.0}, Field7: {Field0: 0.0, Field1: 0.0}};
      var i_469763039 = 0;
      var L_469763040 = (visibleFaces_469762342).length;
      Label8: do {
          Label9: while (true) {
          if (!(i_469763039 < L_469763040)) break Label9;
            fd_469762572 = visibleFaces_469762342[chckIndx(i_469763039, 0, (visibleFaces_469762342).length - 1)];
            drawTexturedTriangle_469762118(r_469762314, fd_469762572.Field2.Field0, fd_469762572.Field2.Field1, fd_469762572.Field5.Field0, fd_469762572.Field5.Field1, fd_469762572.Field3.Field0, fd_469762572.Field3.Field1, fd_469762572.Field6.Field0, fd_469762572.Field6.Field1, fd_469762572.Field4.Field0, fd_469762572.Field4.Field1, fd_469762572.Field7.Field0, fd_469762572.Field7.Field1, fd_469762572.Field1);
            i_469763039 = addInt(i_469763039, 1);
            if (!(((visibleFaces_469762342).length == L_469763040))) {
            failedAssertImpl_218103864(makeNimstrLit("iterators.nim(240, 11) `len(a) == L` the length of the seq changed while iterating over it"));
            }
            
          }
      } while (false);
    } while (false);

  
}

function renderToBuffer_469762636(r_469762637) {
      var Temporary1;

    clear_469762116(r_469762637);
    var hasTexture_469762638 = false;
    hasTexture_469762638 = !!r_469762637.texture && !!r_469762637.texture.jsData && !!r_469762637.texture.jsData.data;
      if (!(0 < (r_469762637.model.vertices).length)) Temporary1 = false; else {        Temporary1 = hasTexture_469762638;      }    if (Temporary1) {
    drawModel_469762313(r_469762637);
    }
    

  
}

function renderAscii_469762648(r_469762649) {
    renderToBuffer_469762636(r_469762649);
    var cols_469762650 = divInt(r_469762649.width, 6);
    var rows_469762651 = divInt(r_469762649.height, 6);
    r_469762649.ctx.fillStyle='#14141e';
    r_469762649.ctx.fillRect(0,0,r_469762649.width,r_469762649.height);
    r_469762649.ctx.font='6px monospace';
    r_469762649.ctx.textBaseline='top';
    Label1: do {
      var row_469762656 = 0;
      var i_469763023 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(i_469763023 < rows_469762651)) break Label3;
            row_469762656 = i_469763023;
            Label4: do {
              var col_469762661 = 0;
              var i_469763021 = 0;
              Label5: do {
                  Label6: while (true) {
                  if (!(i_469763021 < cols_469762650)) break Label6;
                    col_469762661 = i_469763021;
                    var totalR_469762662 = 0;
                    var totalG_469762663 = 0;
                    var totalB_469762664 = 0;
                    var totalBright_469762665 = 0;
                    Label7: do {
                      var dy_469762670 = 0;
                      var i_469763019 = 0;
                      Label8: do {
                          Label9: while (true) {
                          if (!(i_469763019 < 6)) break Label9;
                            dy_469762670 = i_469763019;
                            Label10: do {
                              var dx_469762675 = 0;
                              var i_469763017 = 0;
                              Label11: do {
                                  Label12: while (true) {
                                  if (!(i_469763017 < 6)) break Label12;
                                    dx_469762675 = i_469763017;
                                    var x_469762676 = addInt(mulInt(col_469762661, 6), dx_469762675);
                                    var y_469762677 = addInt(mulInt(row_469762656, 6), dy_469762670);
                                    var idx_469762678 = mulInt(addInt(mulInt(y_469762677, r_469762649.width), x_469762676), 4);
                                    var pr_469762679 = 0;
                                    var pg_469762680 = 0;
                                    var pb_469762681 = 0;
                                    pr_469762679=r_469762649.pixels[idx_469762678];
                                    pg_469762680=r_469762649.pixels[idx_469762678+1];
                                    pb_469762681=r_469762649.pixels[idx_469762678+2];
                                    totalR_469762662 = addInt(totalR_469762662, pr_469762679);
                                    totalG_469762663 = addInt(totalG_469762663, pg_469762680);
                                    totalB_469762664 = addInt(totalB_469762664, pb_469762681);
                                    totalBright_469762665 = addInt(totalBright_469762665, divInt(addInt(addInt(pr_469762679, pg_469762680), pb_469762681), 3));
                                    i_469763017 = addInt(i_469763017, 1);
                                  }
                              } while (false);
                            } while (false);
                            i_469763019 = addInt(i_469763019, 1);
                          }
                      } while (false);
                    } while (false);
                    var count_469762698 = 36;
                    var avgR_469762699 = divInt(totalR_469762662, count_469762698);
                    var avgG_469762700 = divInt(totalG_469762663, count_469762698);
                    var avgB_469762701 = divInt(totalB_469762664, count_469762698);
                    var avgBright_469762702 = divInt(totalBright_469762665, count_469762698);
                    if ((25 < avgBright_469762702)) {
                    var charIdx_469762703 = nimMin(divInt(mulInt(avgBright_469762702, 9), 255), 9);
                    var ch_469762704 = makeNimstrLit(" .:-=+*#%@")[chckIndx(charIdx_469762703, 0, (makeNimstrLit(" .:-=+*#%@")).length - 1)];
                    r_469762649.ctx.fillStyle='rgb(avgR_469762699,avgG_469762700,avgB_469762701)';
                    r_469762649.ctx.fillText('ch_469762704',mulInt(col_469762661, 6),mulInt(row_469762656, 6));
                    }
                    
                    i_469763021 = addInt(i_469763021, 1);
                  }
              } while (false);
            } while (false);
            i_469763023 = addInt(i_469763023, 1);
          }
      } while (false);
    } while (false);

  
}

function renderNormal_469762646(r_469762647) {
    renderToBuffer_469762636(r_469762647);
    r_469762647.ctx.putImageData(r_469762647.imageData, 0, 0);

  
}

function render_469762705(r_469762706) {
    if (r_469762706.asciiMode) {
    renderAscii_469762648(r_469762706);
    }
    else {
    renderNormal_469762646(r_469762706);
    }
    

  
}

function animate(timestamp_469762990) {
      var Temporary1;

      if (!renderer_469762103[0].autoRotate) Temporary1 = false; else {        Temporary1 = !(renderer_469762103[0].dragging);      }    if (Temporary1) {
    HEX2BHEX3D_989857831(renderer_469762103[0], "rotationY", 0.01);
    }
    
    render_469762705(renderer_469762103[0]);
    var _ = window.requestAnimationFrame(animate);

  
}

function substr_33557906(s_33557907, first_33557908, last_33557909) {
  var result_33557910 = [];

    var first_33557911 = nimMax(first_33557908, 0);
    var L_33557912 = nimMax(addInt(subInt(nimMin(last_33557909, (s_33557907).length - 1), first_33557911), 1), 0);
    result_33557910 = nimCopy(null, mnewString(chckRange(L_33557912, 0, 2147483647)), NTI33554439);
    Label1: do {
      var i_33557917 = 0;
      var colontmp__469763232 = 0;
      colontmp__469763232 = subInt(L_33557912, 1);
      var res_469763233 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(res_469763233 <= colontmp__469763232)) break Label3;
            i_33557917 = res_469763233;
            result_33557910[chckIndx(i_33557917, 0, (result_33557910).length - 1)] = s_33557907[chckIndx(addInt(i_33557917, first_33557911), 0, (s_33557907).length - 1)];
            res_469763233 = addInt(res_469763233, 1);
          }
      } while (false);
    } while (false);

  return result_33557910;

}

function nsuSplitWhitespace(s_989856384, maxsplit_989856385) {
  var result_989856386 = [];

    result_989856386 = nimCopy(null, [], NTI989856224);
    Label1: do {
      var xHEX60gensym76_989856392 = [];
      var lastHEX60gensym58_469763239 = 0;
      var splitsHEX60gensym58_469763240 = maxsplit_989856385;
      if (false) {
      failedAssertImpl_218103864(makeNimstrLit("strutils.nim(382, 9) `not (\'\\x00\' in Whitespace)` "));
      }
      
      Label2: do {
          Label3: while (true) {
          if (!(lastHEX60gensym58_469763239 < (s_989856384).length)) break Label3;
            Label4: do {
                Label5: while (true) {
                if (!((lastHEX60gensym58_469763239 < (s_989856384).length) && (ConstSet3[s_989856384[chckIndx(lastHEX60gensym58_469763239, 0, (s_989856384).length - 1)]] != undefined))) break Label5;
                  lastHEX60gensym58_469763239 = addInt(lastHEX60gensym58_469763239, 1);
                }
            } while (false);
            var firstHEX60gensym58_469763243 = lastHEX60gensym58_469763239;
            Label6: do {
                Label7: while (true) {
                if (!((lastHEX60gensym58_469763239 < (s_989856384).length) && !((ConstSet4[s_989856384[chckIndx(lastHEX60gensym58_469763239, 0, (s_989856384).length - 1)]] != undefined)))) break Label7;
                  lastHEX60gensym58_469763239 = addInt(lastHEX60gensym58_469763239, 1);
                }
            } while (false);
            if ((firstHEX60gensym58_469763243 <= subInt(lastHEX60gensym58_469763239, 1))) {
            if ((splitsHEX60gensym58_469763240 == 0)) {
            lastHEX60gensym58_469763239 = (s_989856384).length;
            }
            
            xHEX60gensym76_989856392 = substr_33557906(s_989856384, firstHEX60gensym58_469763243, subInt(lastHEX60gensym58_469763239, 1));
            var Temporary8 = nimCopy(null, xHEX60gensym76_989856392, NTI33554439);
            result_989856386.push(Temporary8);;
            if ((splitsHEX60gensym58_469763240 == 0)) {
            break Label2;
            }
            
            splitsHEX60gensym58_469763240 = subInt(splitsHEX60gensym58_469763240, 1);
            }
            
          }
      } while (false);
    } while (false);

  return result_989856386;

}

function parseFloatNative_33557268(a_33557269) {
  var result_33557270 = 0.0;

    var a2_33557271 = toJSStr(a_33557269);
      result_33557270 = Number(a2_33557271);
  

  return result_33557270;

}

function npuParseFloat(s_1006633372, number_1006633373, number_1006633373_Idx, start_1006633374) {
  var result_1006633375 = 0;

    var bf_1006633376 = [0.0];
    result_1006633375 = nimParseBiggestFloat(s_1006633372, bf_1006633376, 0, start_1006633374);
    if (!((result_1006633375 == 0))) {
    number_1006633373[number_1006633373_Idx] = bf_1006633376[0];
    }
    

  return result_1006633375;

}

function nsuParseFloat(s_989856562) {
      var Temporary1;

  var result_989856563 = [0.0];

    result_989856563[0] = 0.0;
    var L_989856564 = npuParseFloat(s_989856562, result_989856563, 0, 0);
      if (!((L_989856564 == (s_989856562).length))) Temporary1 = true; else {        Temporary1 = (L_989856564 == 0);      }    if (Temporary1) {
    raiseException({message: (makeNimstrLit("invalid float: ") || []).concat(s_989856562 || []), parent: null, m_type: NTI33555125, name: null, trace: [], up: null}, "ValueError");
    }
    

  return result_989856563[0];

}

function nsuSplitChar(s_989856235, sep_989856236, maxsplit_989856237) {
  var result_989856238 = [];

    result_989856238 = nimCopy(null, [], NTI989856072);
    Label1: do {
      var xHEX60gensym66_989856244 = [];
      var lastHEX60gensym33_469763254 = 0;
      var splitsHEX60gensym33_469763255 = maxsplit_989856237;
      Label2: do {
          Label3: while (true) {
          if (!(lastHEX60gensym33_469763254 <= (s_989856235).length)) break Label3;
            var firstHEX60gensym33_469763257 = lastHEX60gensym33_469763254;
            Label4: do {
                Label5: while (true) {
                if (!((lastHEX60gensym33_469763254 < (s_989856235).length) && !((s_989856235[chckIndx(lastHEX60gensym33_469763254, 0, (s_989856235).length - 1)] == sep_989856236)))) break Label5;
                  lastHEX60gensym33_469763254 = addInt(lastHEX60gensym33_469763254, 1);
                }
            } while (false);
            if ((splitsHEX60gensym33_469763255 == 0)) {
            lastHEX60gensym33_469763254 = (s_989856235).length;
            }
            
            xHEX60gensym66_989856244 = substr_33557906(s_989856235, firstHEX60gensym33_469763257, subInt(lastHEX60gensym33_469763254, 1));
            var Temporary6 = nimCopy(null, xHEX60gensym66_989856244, NTI33554439);
            result_989856238.push(Temporary6);;
            if ((splitsHEX60gensym33_469763255 == 0)) {
            break Label2;
            }
            
            splitsHEX60gensym33_469763255 = subInt(splitsHEX60gensym33_469763255, 1);
            lastHEX60gensym33_469763254 = addInt(lastHEX60gensym33_469763254, 1);
          }
      } while (false);
    } while (false);

  return result_989856238;

}

function integerOutOfRangeError_1006633208() {
    raiseException({message: makeNimstrLit("Parsed integer outside of valid range"), parent: null, m_type: NTI33555125, name: null, trace: [], up: null}, "ValueError");

  
}

function rawParseInt_1006633210(s_1006633211, b_1006633212, b_1006633212_Idx, start_1006633213) {
      var Temporary1;
          var Temporary4;
      var Temporary7;

  var result_1006633214 = 0;

    var sign_1006633215 = -1;
    var i_1006633216 = start_1006633213;
    if ((i_1006633216 < (s_1006633211).length)) {
    if ((s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)] == 43)) {
    i_1006633216 += 1;
    }
    else {
    if ((s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)] == 45)) {
    i_1006633216 += 1;
    sign_1006633215 = 1;
    }
    }
    }
    
      if (!(i_1006633216 < (s_1006633211).length)) Temporary1 = false; else {        Temporary1 = (ConstSet12[s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)]] != undefined);      }    if (Temporary1) {
    b_1006633212[b_1006633212_Idx] = 0;
    Label2: do {
        Label3: while (true) {
          if (!(i_1006633216 < (s_1006633211).length)) Temporary4 = false; else {            Temporary4 = (ConstSet13[s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)]] != undefined);          }        if (!Temporary4) break Label3;
          var c_1006633239 = (s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)] - 48);
          if ((Math.trunc((-9223372036854775808 + c_1006633239) / 10) <= b_1006633212[b_1006633212_Idx])) {
          b_1006633212[b_1006633212_Idx] = ((b_1006633212[b_1006633212_Idx] * 10) - c_1006633239);
          }
          else {
          integerOutOfRangeError_1006633208();
          }
          
          i_1006633216 += 1;
          Label5: do {
              Label6: while (true) {
              if (!((i_1006633216 < (s_1006633211).length) && (s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)] == 95))) break Label6;
                i_1006633216 += 1;
              }
          } while (false);
        }
    } while (false);
      if (!(sign_1006633215 == -1)) Temporary7 = false; else {        Temporary7 = (b_1006633212[b_1006633212_Idx] == -9223372036854775808);      }    if (Temporary7) {
    integerOutOfRangeError_1006633208();
    }
    else {
      b_1006633212[b_1006633212_Idx] = (b_1006633212[b_1006633212_Idx] * sign_1006633215);
      result_1006633214 = (i_1006633216 - start_1006633213);
    }
    
    }
    

  return result_1006633214;

}

function npuParseBiggestInt(s_1006633257, number_1006633258, number_1006633258_Idx, start_1006633259) {
  var result_1006633260 = 0;

    var res_1006633261 = [0];
    result_1006633260 = rawParseInt_1006633210(s_1006633257, res_1006633261, 0, start_1006633259);
    if (!((result_1006633260 == 0))) {
    number_1006633258[number_1006633258_Idx] = res_1006633261[0];
    }
    

  return result_1006633260;

}

function npuParseInt(s_1006633263, number_1006633264, number_1006633264_Idx, start_1006633265) {
      var Temporary1;

  var result_1006633266 = 0;

    var res_1006633267 = [0];
    result_1006633266 = npuParseBiggestInt(s_1006633263, res_1006633267, 0, start_1006633265);
      if ((res_1006633267[0] < -2147483648)) Temporary1 = true; else {        Temporary1 = (2147483647 < res_1006633267[0]);      }    if (Temporary1) {
    integerOutOfRangeError_1006633208();
    }
    
    if (!((result_1006633266 == 0))) {
    number_1006633264[number_1006633264_Idx] = chckRange(res_1006633267[0], -2147483648, 2147483647);
    }
    

  return result_1006633266;

}

function nsuParseInt(s_989856542) {
      var Temporary1;

  var result_989856543 = [0];

    result_989856543[0] = 0;
    var L_989856544 = npuParseInt(s_989856542, result_989856543, 0, 0);
      if (!((L_989856544 == (s_989856542).length))) Temporary1 = true; else {        Temporary1 = (L_989856544 == 0);      }    if (Temporary1) {
    raiseException({message: (makeNimstrLit("invalid integer: ") || []).concat(s_989856542 || []), parent: null, m_type: NTI33555125, name: null, trace: [], up: null}, "ValueError");
    }
    

  return result_989856543[0];

}

function parseObjContent_469762707(content_469762708) {
            var Temporary6;
                
function parseFaceIndices_469762763(s_469762764) {
                      var Temporary1;

                  var result_469762767 = {Field0: 0, Field1: 0};

                    var parts_469762768 = nsuSplitChar(s_469762764, 47, -1);
                    var vi_469762769 = subInt(nsuParseInt(parts_469762768[chckIndx(0, 0, (parts_469762768).length - 1)]), 1);
                    var ti_469762770 = -1;
                      if (!(2 <= (parts_469762768).length)) Temporary1 = false; else {                        Temporary1 = (0 < (parts_469762768[chckIndx(1, 0, (parts_469762768).length - 1)]).length);                      }                    if (Temporary1) {
                    ti_469762770 = subInt(nsuParseInt(parts_469762768[chckIndx(1, 0, (parts_469762768).length - 1)]), 1);
                    }
                    
                    result_469762767 = nimCopy(result_469762767, {Field0: vi_469762769, Field1: ti_469762770}, NTI469762450);

                  return result_469762767;

                }

  var result_469762709 = ({vertices: [], texCoords: [], faces: []});

    var vertices_469762714 = [];
    var texCoords_469762719 = [];
    var faces_469762724 = [];
    Label1: do {
      var line_469762725 = [];
      var first_469763226 = 0;
      var last_469763227 = 0;
      var eolpos_469763228 = 0;
      Label2: do {
          Label3: while (true) {
          if (!true) break Label3;
            Label4: do {
                Label5: while (true) {
                if (!((last_469763227 < (content_469762708).length) && !((ConstSet2[content_469762708[chckIndx(last_469763227, 0, (content_469762708).length - 1)]] != undefined)))) break Label5;
                  last_469763227 = addInt(last_469763227, 1);
                }
            } while (false);
            eolpos_469763228 = last_469763227;
            if ((last_469763227 < (content_469762708).length)) {
            if ((content_469762708[chckIndx(last_469763227, 0, (content_469762708).length - 1)] == 10)) {
            last_469763227 = addInt(last_469763227, 1);
            }
            else {
            if ((content_469762708[chckIndx(last_469763227, 0, (content_469762708).length - 1)] == 13)) {
            last_469763227 = addInt(last_469763227, 1);
            if (((last_469763227 < (content_469762708).length) && (content_469762708[chckIndx(last_469763227, 0, (content_469762708).length - 1)] == 10))) {
            last_469763227 = addInt(last_469763227, 1);
            }
            
            }
            }
            }
            
            if (false) {
            Temporary6 = subInt(last_469763227, 1);
            }
            else {
            Temporary6 = subInt(eolpos_469763228, 1);
            }
            
            line_469762725 = substr_33557906(content_469762708, first_469763226, Temporary6);
            Label7: do {
              var parts_469762726 = nsuSplitWhitespace(line_469762725, -1);
              if (((parts_469762726).length == 0)) {
              break Label7;
              }
              
              switch (toJSStr(parts_469762726[chckIndx(0, 0, (parts_469762726).length - 1)])) {
              case "v":
                if ((4 <= (parts_469762726).length)) {
                var x_469762736 = nsuParseFloat(parts_469762726[chckIndx(1, 0, (parts_469762726).length - 1)]);
                var y_469762737 = nsuParseFloat(parts_469762726[chckIndx(2, 0, (parts_469762726).length - 1)]);
                var z_469762738 = nsuParseFloat(parts_469762726[chckIndx(3, 0, (parts_469762726).length - 1)]);
                vertices_469762714.push(vec3_1157627910(x_469762736, y_469762737, z_469762738));;
                }
                
                break;
              case "vt":
                if ((3 <= (parts_469762726).length)) {
                var u_469762749 = nsuParseFloat(parts_469762726[chckIndx(1, 0, (parts_469762726).length - 1)]);
                var v_469762750 = nsuParseFloat(parts_469762726[chckIndx(2, 0, (parts_469762726).length - 1)]);
                texCoords_469762719.push({Field0: u_469762749, Field1: v_469762750});;
                }
                
                break;
              case "f":
                if ((4 <= (parts_469762726).length)) {
                var f0_469762779 = parseFaceIndices_469762763(parts_469762726[chckIndx(1, 0, (parts_469762726).length - 1)]);
                var f1_469762780 = parseFaceIndices_469762763(parts_469762726[chckIndx(2, 0, (parts_469762726).length - 1)]);
                var f2_469762781 = parseFaceIndices_469762763(parts_469762726[chckIndx(3, 0, (parts_469762726).length - 1)]);
                faces_469762724.push({v: new Int32Array([f0_469762779.Field0, f1_469762780.Field0, f2_469762781.Field0]), t: new Int32Array([f0_469762779.Field1, f1_469762780.Field1, f2_469762781.Field1])});;
                if ((5 <= (parts_469762726).length)) {
                var f3_469762792 = parseFaceIndices_469762763(parts_469762726[chckIndx(4, 0, (parts_469762726).length - 1)]);
                faces_469762724.push({v: new Int32Array([f0_469762779.Field0, f2_469762781.Field0, f3_469762792.Field0]), t: new Int32Array([f0_469762779.Field1, f2_469762781.Field1, f3_469762792.Field1])});;
                }
                
                }
                
                break;
              default: 
                break;
              }
            } while (false);
            if ((eolpos_469763228 == last_469763227)) {
            break Label2;
            }
            
            first_469763226 = last_469763227;
          }
      } while (false);
    } while (false);
    result_469762709 = nimCopy(result_469762709, {vertices: nimCopy(null, vertices_469762714, NTI469762398), texCoords: nimCopy(null, texCoords_469762719, NTI469762407), faces: nimCopy(null, faces_469762724, NTI469762416)}, NTI469762075);

  return result_469762709;

}
async function loadModel_469762898(url_469762899) {
  var result_469762902 = null;

    var response_469762916 = (await fetch(toJSStr(url_469762899)));
    var text_469762921 = (await response_469762916.text());
    result_469762902 = parseObjContent_469762707(cstrToNimstr(text_469762921));

  return result_469762902;

}

function loadTexture_469762961(url_469762962) {
  var result_469762965 = null;

    var promise_469762967 = null;
    promise_469762967 = new Promise((resolve, reject) => {    const urlStr = url_469762962;
    const img = new Image();
    img.crossOrigin = 'anonymous';
    img.onload = () => {
      const canvas = document.createElement('canvas');
      canvas.width = img.width;
      canvas.height = img.height;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(img, 0, 0);
      const imageData = ctx.getImageData(0, 0, img.width, img.height);
      resolve({ width: img.width, height: img.height, data: imageData.data });
    };
    img.onerror = () => resolve({ width: 1, height: 1, data: new Uint8ClampedArray([128,128,128,255]) });
    img.src = urlStr;
  });
    result_469762965 = promise_469762967;

  return result_469762965;

}

function jsTextureToNim_469762977(jsObj_469762978) {
  var result_469762979 = null;

    result_469762979 = {width: 0, height: 0, jsData: null};
    result_469762979.width=jsObj_469762978.width;result_469762979.height=jsObj_469762978.height;result_469762979.jsData=jsObj_469762978;

  return result_469762979;

}

function selectModel(modelUrl_469763186, textureUrl_469763187) {
    async function load_469763189() {
      var result_469763191 = null;

      BeforeRet: do {
        var statusEl_469763197 = document.getElementById("status");
        statusEl_469763197.innerHTML = "Loading model...";
        renderer_469762103[0].model = nimCopy(renderer_469762103[0].model, (await loadModel_469762898(cstrToNimstr(modelUrl_469763186))), NTI469762075);
        statusEl_469763197.innerHTML = "Loading texture...";
        var texJs_469763206 = (await loadTexture_469762961(textureUrl_469763187));
        renderer_469762103[0].texture = jsTextureToNim_469762977(texJs_469763206);
        statusEl_469763197.innerHTML = toJSStr((makeNimstrLit("Vertices: ") || []).concat(HEX24_335544323((renderer_469762103[0].model.vertices).length) || [],makeNimstrLit(" | Faces: ") || [],HEX24_335544323((renderer_469762103[0].model.faces).length) || [],makeNimstrLit(" | Tex: ") || [],HEX24_335544323(renderer_469762103[0].texture.width) || [],makeNimstrLit("x") || [],HEX24_335544323(renderer_469762103[0].texture.height) || []));
        result_469763191 = undefined;
        break BeforeRet;
      } while (false);

      return result_469763191;

    }

    var _ = load_469763189();

  
}

function toggleAutoRotate() {
    renderer_469762103[0].autoRotate = !(renderer_469762103[0].autoRotate);

  
}

function toggleAscii() {
    renderer_469762103[0].asciiMode = !(renderer_469762103[0].asciiMode);

  
}

function initRenderer_469763158(canvasId_469763159, width_469763160, height_469763161) {
  var result_469763162 = null;

    var canvas_469763163 = document.getElementById(canvasId_469763159);
    canvas_469763163.setAttribute("width", toJSStr(HEX24_335544323(width_469763160)));
    canvas_469763163.setAttribute("height", toJSStr(HEX24_335544323(height_469763161)));
    var ctx_469763164 = null;
    ctx_469763164 = canvas_469763163.getContext('2d');
    var imageData_469763165 = null;
    imageData_469763165 = ctx_469763164.createImageData(width_469763160, height_469763161);
    var pixels_469763166 = null;
    pixels_469763166 = imageData_469763165.data;
    result_469763162 = {canvas: canvas_469763163, ctx: ctx_469763164, width: width_469763160, height: height_469763161, imageData: imageData_469763165, pixels: pixels_469763166, model: {vertices: [], texCoords: [], faces: []}, rotationY: 0.0, rotationX: 0.0, autoRotate: true, asciiMode: false, dragging: false, texture: null, lastMouseX: 0, lastMouseY: 0};

  return result_469763162;

}

function setupEventHandlers_469763062(r_469763063) {
    
function HEX3Aanonymous_469763064(e_469763065) {
        var me_469763066 = e_469763065;
        r_469763063.dragging = true;
        r_469763063.lastMouseX = me_469763066.clientX;
        r_469763063.lastMouseY = me_469763066.clientY;

      
    }
    
function HEX3Aanonymous_469763085(e_469763086) {
        r_469763063.dragging = false;

      
    }
    
function HEX3Aanonymous_469763087(e_469763088) {
        if (r_469763063.dragging) {
        var me_469763089 = e_469763088;
        var deltaX_469763090 = subInt(me_469763089.clientX, r_469763063.lastMouseX);
        var deltaY_469763091 = subInt(me_469763089.clientY, r_469763063.lastMouseY);
        HEX2BHEX3D_989857831(r_469763063, "rotationY", (deltaX_469763090 * 0.01));
        HEX2BHEX3D_989857831(r_469763063, "rotationX", (deltaY_469763091 * 0.01));
        r_469763063.lastMouseX = me_469763089.clientX;
        r_469763063.lastMouseY = me_469763089.clientY;
        }
        

      
    }
    
function HEX3Aanonymous_469763100(e_469763101) {
        var te_469763102 = e_469763101;
        if ((0 < (te_469763102.touches).length)) {
        r_469763063.dragging = true;
        r_469763063.lastMouseX = te_469763102.touches[chckIndx(0, 0, (te_469763102.touches).length - 1)].clientX;
        r_469763063.lastMouseY = te_469763102.touches[chckIndx(0, 0, (te_469763102.touches).length - 1)].clientY;
        }
        

      
    }
    
function HEX3Aanonymous_469763119(e_469763120) {
        r_469763063.dragging = false;

      
    }
    
function HEX3Aanonymous_469763121(e_469763122) {
        if (r_469763063.dragging) {
        var te_469763123 = e_469763122;
        if ((0 < (te_469763123.touches).length)) {
        var deltaX_469763130 = subInt(te_469763123.touches[chckIndx(0, 0, (te_469763123.touches).length - 1)].clientX, r_469763063.lastMouseX);
        var deltaY_469763131 = subInt(te_469763123.touches[chckIndx(0, 0, (te_469763123.touches).length - 1)].clientY, r_469763063.lastMouseY);
        HEX2BHEX3D_989857831(r_469763063, "rotationY", (deltaX_469763130 * 0.01));
        HEX2BHEX3D_989857831(r_469763063, "rotationX", (deltaY_469763131 * 0.01));
        r_469763063.lastMouseX = te_469763123.touches[chckIndx(0, 0, (te_469763123.touches).length - 1)].clientX;
        r_469763063.lastMouseY = te_469763123.touches[chckIndx(0, 0, (te_469763123.touches).length - 1)].clientY;
        }
        
        }
        

      
    }

    r_469763063.canvas.addEventListener("mousedown", HEX3Aanonymous_469763064, false);
    document.addEventListener("mouseup", HEX3Aanonymous_469763085, false);
    document.addEventListener("mousemove", HEX3Aanonymous_469763087, false);
    r_469763063.canvas.addEventListener("touchstart", HEX3Aanonymous_469763100, false);
    document.addEventListener("touchend", HEX3Aanonymous_469763119, false);
    document.addEventListener("touchmove", HEX3Aanonymous_469763121, false);

  
}

function main() {
    renderer_469762103[0] = initRenderer_469763158("canvas", 600, 600);
    setupEventHandlers_469763062(renderer_469762103[0]);
    var buildInfo_469763265 = document.getElementById("buildInfo");
    if (!((buildInfo_469763265 == null))) {
    buildInfo_469763265.innerHTML = "Build: 2026-01-06 00:02:39";
    }
    
    selectModel("models/diablo3_pose.obj", "models/diablo3_pose_diffuse.png");
    var _ = window.requestAnimationFrame(animate);

  
}

function HEX3Aanonymous_469763269(e_469763270) {
    main();

  
}
window.onload = HEX3Aanonymous_469763269;
