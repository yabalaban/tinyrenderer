/* Generated by the Nim Compiler v1.6.14 */
var framePtr = null;
var excHandler = 0;
var lastJSError = null;
var NTI503316510 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI503316509 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI503316506 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI503316760 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI503316751 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI989856072 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI33555114 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555125 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI989856224 = {size: 0, kind: 24, base: null, node: null, finalizer: null};
var NTI503316595 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI33555121 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555124 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI503316596 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI503316505 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI33554456 = {size: 0,kind: 31,base: null,node: null,finalizer: null};
var NTI503316580 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI33554435 = {size: 0,kind: 36,base: null,node: null,finalizer: null};
var NTI1174405123 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI33555128 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555130 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33554462 = {size: 0,kind: 41,base: null,node: null,finalizer: null};
var NTI503316503 = {size: 0, kind: 18, base: null, node: null, finalizer: null};
var NTI33555083 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555165 = {size: 0, kind: 22, base: null, node: null, finalizer: null};
var NTI33554439 = {size: 0,kind: 28,base: null,node: null,finalizer: null};
var NTI33554440 = {size: 0,kind: 29,base: null,node: null,finalizer: null};
var NTI33555164 = {size: 0, kind: 22, base: null, node: null, finalizer: null};
var NTI33555112 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555113 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555120 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NTI33555122 = {size: 0, kind: 17, base: null, node: null, finalizer: null};
var NNI33555122 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555122.node = NNI33555122;
var NNI33555120 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555120.node = NNI33555120;
var NNI33555113 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555113.node = NNI33555113;
NTI33555164.base = NTI33555112;
NTI33555165.base = NTI33555112;
var NNI33555112 = {kind: 2, len: 5, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "parent", len: 0, typ: NTI33555164, name: "parent", sons: null}, 
{kind: 1, offset: "name", len: 0, typ: NTI33554440, name: "name", sons: null}, 
{kind: 1, offset: "message", len: 0, typ: NTI33554439, name: "msg", sons: null}, 
{kind: 1, offset: "trace", len: 0, typ: NTI33554439, name: "trace", sons: null}, 
{kind: 1, offset: "up", len: 0, typ: NTI33555165, name: "up", sons: null}]};
NTI33555112.node = NNI33555112;
var NNI33555083 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555083.node = NNI33555083;
NTI33555112.base = NTI33555083;
NTI33555113.base = NTI33555112;
NTI33555120.base = NTI33555113;
NTI33555122.base = NTI33555120;
var NNI503316503 = {kind: 2, len: 4, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "r", len: 0, typ: NTI33554462, name: "r", sons: null}, 
{kind: 1, offset: "g", len: 0, typ: NTI33554462, name: "g", sons: null}, 
{kind: 1, offset: "b", len: 0, typ: NTI33554462, name: "b", sons: null}, 
{kind: 1, offset: "a", len: 0, typ: NTI33554462, name: "a", sons: null}]};
NTI503316503.node = NNI503316503;
var NNI33555130 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555130.node = NNI33555130;
NTI33555130.base = NTI33555113;
var NNI33555128 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555128.node = NNI33555128;
NTI33555128.base = NTI33555113;
var NNI1174405123 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "x", len: 0, typ: NTI33554435, name: "x", sons: null}, 
{kind: 1, offset: "y", len: 0, typ: NTI33554435, name: "y", sons: null}, 
{kind: 1, offset: "z", len: 0, typ: NTI33554435, name: "z", sons: null}]};
NTI1174405123.node = NNI1174405123;
var NNI503316580 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI33554456, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554456, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI33554435, name: "Field2", sons: null}]};
NTI503316580.node = NNI503316580;
var NNI503316505 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI33554456, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554456, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI33554456, name: "Field2", sons: null}]};
NTI503316505.node = NNI503316505;
var NNI503316596 = {kind: 2, len: 3, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI33554456, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554456, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI33554435, name: "Field2", sons: null}]};
NTI503316596.node = NNI503316596;
var NNI33555124 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555124.node = NNI33555124;
NTI33555124.base = NTI33555113;
var NNI33555121 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555121.node = NNI33555121;
NTI33555121.base = NTI33555120;
var NNI503316595 = {kind: 2, len: 8, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "Field0", len: 0, typ: NTI503316505, name: "Field0", sons: null}, 
{kind: 1, offset: "Field1", len: 0, typ: NTI33554435, name: "Field1", sons: null}, 
{kind: 1, offset: "Field2", len: 0, typ: NTI1174405123, name: "Field2", sons: null}, 
{kind: 1, offset: "Field3", len: 0, typ: NTI1174405123, name: "Field3", sons: null}, 
{kind: 1, offset: "Field4", len: 0, typ: NTI1174405123, name: "Field4", sons: null}, 
{kind: 1, offset: "Field5", len: 0, typ: NTI503316596, name: "Field5", sons: null}, 
{kind: 1, offset: "Field6", len: 0, typ: NTI503316596, name: "Field6", sons: null}, 
{kind: 1, offset: "Field7", len: 0, typ: NTI503316596, name: "Field7", sons: null}]};
NTI503316595.node = NNI503316595;
NTI989856224.base = NTI33554439;
var NNI33555125 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555125.node = NNI33555125;
var NNI33555114 = {kind: 2, len: 0, offset: 0, typ: null, name: null, sons: []};
NTI33555114.node = NNI33555114;
NTI33555114.base = NTI33555112;
NTI33555125.base = NTI33555114;
NTI989856072.base = NTI33554439;
NTI503316751.base = NTI1174405123;
NTI503316760.base = NTI503316505;
NTI503316509.base = NTI1174405123;
NTI503316510.base = NTI503316505;
var NNI503316506 = {kind: 2, len: 2, offset: 0, typ: null, name: null, sons: [{kind: 1, offset: "vertices", len: 0, typ: NTI503316509, name: "vertices", sons: null}, 
{kind: 1, offset: "faces", len: 0, typ: NTI503316510, name: "faces", sons: null}]};
NTI503316506.node = NNI503316506;

function makeNimstrLit(c_33556801) {
      var result = [];
  for (var i = 0; i < c_33556801.length; ++i) {
    result[i] = c_33556801.charCodeAt(i);
  }
  return result;
  

  
}

function toJSStr(s_33556807) {
                    var Temporary5;

  var result_33556808 = null;

    var res_33556842 = newSeq_33556825((s_33556807).length);
    var i_33556843 = 0;
    var j_33556844 = 0;
    Label1: do {
        Label2: while (true) {
        if (!(i_33556843 < (s_33556807).length)) break Label2;
          var c_33556845 = s_33556807[i_33556843];
          if ((c_33556845 < 128)) {
          res_33556842[j_33556844] = String.fromCharCode(c_33556845);
          i_33556843 += 1;
          }
          else {
            var helper_33556857 = newSeq_33556825(0);
            Label3: do {
                Label4: while (true) {
                if (!true) break Label4;
                  var code_33556858 = c_33556845.toString(16);
                  if ((((code_33556858) == null ? 0 : (code_33556858).length) == 1)) {
                  helper_33556857.push("%0");;
                  }
                  else {
                  helper_33556857.push("%");;
                  }
                  
                  helper_33556857.push(code_33556858);;
                  i_33556843 += 1;
                    if (((s_33556807).length <= i_33556843)) Temporary5 = true; else {                      Temporary5 = (s_33556807[i_33556843] < 128);                    }                  if (Temporary5) {
                  break Label3;
                  }
                  
                  c_33556845 = s_33556807[i_33556843];
                }
            } while (false);
++excHandler;
            try {
            res_33556842[j_33556844] = decodeURIComponent(helper_33556857.join(""));
--excHandler;
} catch (EXCEPTION) {
 var prevJSError = lastJSError;
 lastJSError = EXCEPTION;
 --excHandler;
            res_33556842[j_33556844] = helper_33556857.join("");
            lastJSError = prevJSError;
            } finally {
            }
          }
          
          j_33556844 += 1;
        }
    } while (false);
    if (res_33556842.length < j_33556844) { for (var i = res_33556842.length ; i < j_33556844 ; ++i) res_33556842.push(null); }
               else { res_33556842.length = j_33556844; };
    result_33556808 = res_33556842.join("");

  return result_33556808;

}

function raiseException(e_33556667, ename_33556668) {
    e_33556667.name = ename_33556668;
    if ((excHandler == 0)) {
    unhandledException(e_33556667);
    }
    
    throw e_33556667;

  
}

function subInt(a_33556944, b_33556945) {
        var result = a_33556944 - b_33556945;
    checkOverflowInt(result);
    return result;
  

  
}

function mulInt(a_33556948, b_33556949) {
        var result = a_33556948 * b_33556949;
    checkOverflowInt(result);
    return result;
  

  
}

function addInt(a_33556940, b_33556941) {
        var result = a_33556940 + b_33556941;
    checkOverflowInt(result);
    return result;
  

  
}

function setConstr() {
        var result = {};
    for (var i = 0; i < arguments.length; ++i) {
      var x = arguments[i];
      if (typeof(x) == "object") {
        for (var j = x[0]; j <= x[1]; ++j) {
          result[j] = true;
        }
      } else {
        result[x] = true;
      }
    }
    return result;
  

  
}
var ConstSet1 = setConstr(17, 16, 4, 18, 27, 19, 23, 22, 21);

function nimCopy(dest_33557140, src_33557141, ti_33557142) {
  var result_33557151 = null;

    switch (ti_33557142.kind) {
    case 21:
    case 22:
    case 23:
    case 5:
      if (!(isFatPointer_33557131(ti_33557142))) {
      result_33557151 = src_33557141;
      }
      else {
        result_33557151 = [src_33557141[0], src_33557141[1]];
      }
      
      break;
    case 19:
            if (dest_33557140 === null || dest_33557140 === undefined) {
        dest_33557140 = {};
      }
      else {
        for (var key in dest_33557140) { delete dest_33557140[key]; }
      }
      for (var key in src_33557141) { dest_33557140[key] = src_33557141[key]; }
      result_33557151 = dest_33557140;
    
      break;
    case 18:
    case 17:
      if (!((ti_33557142.base == null))) {
      result_33557151 = nimCopy(dest_33557140, src_33557141, ti_33557142.base);
      }
      else {
      if ((ti_33557142.kind == 17)) {
      result_33557151 = (dest_33557140 === null || dest_33557140 === undefined) ? {m_type: ti_33557142} : dest_33557140;
      }
      else {
        result_33557151 = (dest_33557140 === null || dest_33557140 === undefined) ? {} : dest_33557140;
      }
      }
      nimCopyAux(result_33557151, src_33557141, ti_33557142.node);
      break;
    case 24:
    case 4:
    case 27:
    case 16:
            if (src_33557141 === null) {
        result_33557151 = null;
      }
      else {
        if (dest_33557140 === null || dest_33557140 === undefined || dest_33557140.length != src_33557141.length) {
          dest_33557140 = new Array(src_33557141.length);
        }
        result_33557151 = dest_33557140;
        for (var i = 0; i < src_33557141.length; ++i) {
          result_33557151[i] = nimCopy(result_33557151[i], src_33557141[i], ti_33557142.base);
        }
      }
    
      break;
    case 28:
            if (src_33557141 !== null) {
        result_33557151 = src_33557141.slice(0);
      }
    
      break;
    default: 
      result_33557151 = src_33557141;
      break;
    }

  return result_33557151;

}

function mnewString(len_33556893) {
        return new Array(len_33556893);
  

  
}

function chckRange(i_33557189, a_33557190, b_33557191) {
      var Temporary1;

  var result_33557192 = 0;

  BeforeRet: do {
      if (!(a_33557190 <= i_33557189)) Temporary1 = false; else {        Temporary1 = (i_33557189 <= b_33557191);      }    if (Temporary1) {
    result_33557192 = i_33557189;
    break BeforeRet;
    }
    else {
    raiseRangeError();
    }
    
  } while (false);

  return result_33557192;

}

function chckIndx(i_33557184, a_33557185, b_33557186) {
      var Temporary1;

  var result_33557187 = 0;

  BeforeRet: do {
      if (!(a_33557185 <= i_33557184)) Temporary1 = false; else {        Temporary1 = (i_33557184 <= b_33557186);      }    if (Temporary1) {
    result_33557187 = i_33557184;
    break BeforeRet;
    }
    else {
    raiseIndexError(i_33557184, a_33557185, b_33557186);
    }
    
  } while (false);

  return result_33557187;

}

function negInt(a_33556982) {
  var result_33556983 = 0;

    result_33556983 = (a_33556982 * -1);

  return result_33556983;

}

function divInt(a_33556952, b_33556953) {
        if (b_33556953 == 0) raiseDivByZero();
    if (b_33556953 == -1 && a_33556952 == 2147483647) raiseOverflow();
    return Math.trunc(a_33556952 / b_33556953);
  

  
}

function nimMax(a_33556998, b_33556999) {
    var Temporary1;

  var result_33557000 = 0;

  BeforeRet: do {
    if ((b_33556999 <= a_33556998)) {
    Temporary1 = a_33556998;
    }
    else {
    Temporary1 = b_33556999;
    }
    
    result_33557000 = Temporary1;
    break BeforeRet;
  } while (false);

  return result_33557000;

}

function absInt(a_33556988) {
    var Temporary1;

  var result_33556989 = 0;

    if ((a_33556988 < 0)) {
    Temporary1 = (a_33556988 * -1);
    }
    else {
    Temporary1 = a_33556988;
    }
    
    result_33556989 = Temporary1;

  return result_33556989;

}
var ConstSet2 = setConstr(13, 10);

function nimMin(a_33556994, b_33556995) {
    var Temporary1;

  var result_33556996 = 0;

  BeforeRet: do {
    if ((a_33556994 <= b_33556995)) {
    Temporary1 = a_33556994;
    }
    else {
    Temporary1 = b_33556995;
    }
    
    result_33556996 = Temporary1;
    break BeforeRet;
  } while (false);

  return result_33556996;

}
var ConstSet3 = setConstr(32, 9, 11, 13, 10, 12);
var ConstSet4 = setConstr(32, 9, 11, 13, 10, 12);
var ConstSet5 = setConstr([97, 122], [65, 90], [48, 57], 95);
var ConstSet6 = setConstr([97, 122], [65, 90], [48, 57], 95);

function addChar(x_33557255, c_33557256) {
    x_33557255.push(c_33557256);

  
}
var ConstSet7 = setConstr([48, 57]);
var ConstSet8 = setConstr([48, 57]);
var ConstSet9 = setConstr(101, 69);
var ConstSet10 = setConstr([48, 57]);
var ConstSet11 = setConstr([48, 57]);

function nimParseBiggestFloat(s_33557273, number_33557274, number_33557274_Idx, start_33557275) {
    var Temporary1;

  var result_33557276 = 0;

  BeforeRet: do {
    var sign_33557277 = false;
    var i_33557278 = start_33557275;
    if ((s_33557273[i_33557278] == 43)) {
    i_33557278 += 1;
    }
    else {
    if ((s_33557273[i_33557278] == 45)) {
    sign_33557277 = true;
    i_33557278 += 1;
    }
    }
    if (((s_33557273[i_33557278] == 78) || (s_33557273[i_33557278] == 110))) {
    if (((s_33557273[(i_33557278 + 1)] == 65) || (s_33557273[(i_33557278 + 1)] == 97))) {
    if (((s_33557273[(i_33557278 + 2)] == 78) || (s_33557273[(i_33557278 + 2)] == 110))) {
    if (!((ConstSet5[s_33557273[(i_33557278 + 3)]] != undefined))) {
    number_33557274[number_33557274_Idx] = NaN;
    result_33557276 = ((i_33557278 + 3) - start_33557275);
    break BeforeRet;
    }
    
    }
    
    }
    
    result_33557276 = 0;
    break BeforeRet;
    }
    
    if (((s_33557273[i_33557278] == 73) || (s_33557273[i_33557278] == 105))) {
    if (((s_33557273[(i_33557278 + 1)] == 78) || (s_33557273[(i_33557278 + 1)] == 110))) {
    if (((s_33557273[(i_33557278 + 2)] == 70) || (s_33557273[(i_33557278 + 2)] == 102))) {
    if (!((ConstSet6[s_33557273[(i_33557278 + 3)]] != undefined))) {
    if (sign_33557277) {
    Temporary1 = -Infinity;
    }
    else {
    Temporary1 = Infinity;
    }
    
    number_33557274[number_33557274_Idx] = Temporary1;
    result_33557276 = ((i_33557278 + 3) - start_33557275);
    break BeforeRet;
    }
    
    }
    
    }
    
    result_33557276 = 0;
    break BeforeRet;
    }
    
    var buf_33557295 = [];
    if (sign_33557277) {
    addChar(buf_33557295, 45);;
    }
    
    Label2: do {
        Label3: while (true) {
        if (!(ConstSet7[s_33557273[i_33557278]] != undefined)) break Label3;
          addChar(buf_33557295, s_33557273[i_33557278]);;
          i_33557278 += 1;
          Label4: do {
              Label5: while (true) {
              if (!(s_33557273[i_33557278] == 95)) break Label5;
                i_33557278 += 1;
              }
          } while (false);
        }
    } while (false);
    if ((s_33557273[i_33557278] == 46)) {
    addChar(buf_33557295, s_33557273[i_33557278]);;
    i_33557278 += 1;
    Label6: do {
        Label7: while (true) {
        if (!(ConstSet8[s_33557273[i_33557278]] != undefined)) break Label7;
          addChar(buf_33557295, s_33557273[i_33557278]);;
          i_33557278 += 1;
          Label8: do {
              Label9: while (true) {
              if (!(s_33557273[i_33557278] == 95)) break Label9;
                i_33557278 += 1;
              }
          } while (false);
        }
    } while (false);
    }
    
    if (((buf_33557295).length == (sign_33557277 ? 1 : 0))) {
    result_33557276 = 0;
    break BeforeRet;
    }
    
    if ((ConstSet9[s_33557273[i_33557278]] != undefined)) {
    addChar(buf_33557295, s_33557273[i_33557278]);;
    i_33557278 += 1;
    if ((s_33557273[i_33557278] == 43)) {
    i_33557278 += 1;
    }
    else {
    if ((s_33557273[i_33557278] == 45)) {
    addChar(buf_33557295, s_33557273[i_33557278]);;
    i_33557278 += 1;
    }
    }
    if (!((ConstSet10[s_33557273[i_33557278]] != undefined))) {
    result_33557276 = 0;
    break BeforeRet;
    }
    
    Label10: do {
        Label11: while (true) {
        if (!(ConstSet11[s_33557273[i_33557278]] != undefined)) break Label11;
          addChar(buf_33557295, s_33557273[i_33557278]);;
          i_33557278 += 1;
          Label12: do {
              Label13: while (true) {
              if (!(s_33557273[i_33557278] == 95)) break Label13;
                i_33557278 += 1;
              }
          } while (false);
        }
    } while (false);
    }
    
    number_33557274[number_33557274_Idx] = parseFloatNative_33557268(buf_33557295);
    result_33557276 = (i_33557278 - start_33557275);
  } while (false);

  return result_33557276;

}
var ConstSet12 = setConstr([48, 57]);
var ConstSet13 = setConstr([48, 57]);

function cstrToNimstr(c_33556804) {
      var ln = c_33556804.length;
  var result = new Array(ln);
  var r = 0;
  for (var i = 0; i < ln; ++i) {
    var ch = c_33556804.charCodeAt(i);

    if (ch < 128) {
      result[r] = ch;
    }
    else {
      if (ch < 2048) {
        result[r] = (ch >> 6) | 192;
      }
      else {
        if (ch < 55296 || ch >= 57344) {
          result[r] = (ch >> 12) | 224;
        }
        else {
            ++i;
            ch = 65536 + (((ch & 1023) << 10) | (c_33556804.charCodeAt(i) & 1023));
            result[r] = (ch >> 18) | 240;
            ++r;
            result[r] = ((ch >> 12) & 63) | 128;
        }
        ++r;
        result[r] = ((ch >> 6) & 63) | 128;
      }
      ++r;
      result[r] = (ch & 63) | 128;
    }
    ++r;
  }
  return result;
  

  
}
if (!Math.trunc) {
  Math.trunc = function(v) {
    v = +v;
    if (!isFinite(v)) return v;
    return (v - v % 1) || (v < 0 ? -0 : v === 0 ? v : 0);
  };
}

var objectID_738197666 = [0];
var renderer_503316531 = [null];

function HEX2BHEX3D_989857831(x_989857833, x_989857833_Idx, y_989857834) {
    x_989857833[x_989857833_Idx] = (x_989857833[x_989857833_Idx] + y_989857834);

  
}

function add_33556419(x_33556420, x_33556420_Idx, y_33556421) {
          if (x_33556420[x_33556420_Idx] === null) { x_33556420[x_33556420_Idx] = []; }
      var off = x_33556420[x_33556420_Idx].length;
      x_33556420[x_33556420_Idx].length += y_33556421.length;
      for (var i = 0; i < y_33556421.length; ++i) {
        x_33556420[x_33556420_Idx][off+i] = y_33556421.charCodeAt(i);
      }
    

  
}

function newSeq_33556825(len_33556827) {
  var result_33556828 = [];

    result_33556828 = new Array(len_33556827); for (var i = 0 ; i < len_33556827 ; ++i) { result_33556828[i] = null; }
  return result_33556828;

}

function unhandledException(e_33556663) {
    var buf_33556664 = [[]];
    if (!(((e_33556663.message).length == 0))) {
    buf_33556664[0].push.apply(buf_33556664[0], makeNimstrLit("Error: unhandled exception: "));;
    buf_33556664[0].push.apply(buf_33556664[0], e_33556663.message);;
    }
    else {
    buf_33556664[0].push.apply(buf_33556664[0], makeNimstrLit("Error: unhandled exception"));;
    }
    
    buf_33556664[0].push.apply(buf_33556664[0], makeNimstrLit(" ["));;
    add_33556419(buf_33556664, 0, e_33556663.name);
    buf_33556664[0].push.apply(buf_33556664[0], makeNimstrLit("]\x0A"));;
    var cbuf_33556665 = toJSStr(buf_33556664[0]);
      if (typeof(Error) !== "undefined") {
    throw new Error(cbuf_33556665);
  }
  else {
    throw cbuf_33556665;
  }
  

  
}

function raiseOverflow() {
    raiseException({message: makeNimstrLit("over- or underflow"), parent: null, m_type: NTI33555122, name: null, trace: [], up: null}, "OverflowDefect");

  
}

function checkOverflowInt(a_33556938) {
        if (a_33556938 > 2147483647 || a_33556938 < -2147483648) raiseOverflow();
  

  
}

function setPixel_503316562(r_503316563, x_503316564, y_503316565, c_503316566) {
      var Temporary1;
      var Temporary2;
      var Temporary3;

  BeforeRet: do {
      if ((x_503316564 < 0)) Temporary3 = true; else {        Temporary3 = (r_503316563.width <= x_503316564);      }      if (Temporary3) Temporary2 = true; else {        Temporary2 = (y_503316565 < 0);      }      if (Temporary2) Temporary1 = true; else {        Temporary1 = (r_503316563.height <= y_503316565);      }    if (Temporary1) {
    break BeforeRet;
    }
    
    var flippedY_503316567 = subInt(subInt(r_503316563.height, 1), y_503316565);
    var idx_503316568 = mulInt(addInt(mulInt(flippedY_503316567, r_503316563.width), x_503316564), 4);
    r_503316563.pixels[idx_503316568] = ((c_503316566.r) | 0);
    r_503316563.pixels[addInt(idx_503316568, 1)] = ((c_503316566.g) | 0);
    r_503316563.pixels[addInt(idx_503316568, 2)] = ((c_503316566.b) | 0);
    r_503316563.pixels[addInt(idx_503316568, 3)] = ((c_503316566.a) | 0);
  } while (false);

  
}

function clear_503316589(r_503316590, c_503316591) {
    Label1: do {
      var y_503316596 = 0;
      var i_503317198 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(i_503317198 < r_503316590.height)) break Label3;
            y_503316596 = i_503317198;
            Label4: do {
              var x_503316601 = 0;
              var i_503317196 = 0;
              Label5: do {
                  Label6: while (true) {
                  if (!(i_503317196 < r_503316590.width)) break Label6;
                    x_503316601 = i_503317196;
                    setPixel_503316562(r_503316590, x_503316601, y_503316596, c_503316591);
                    i_503317196 = addInt(i_503317196, 1);
                  }
              } while (false);
            } while (false);
            i_503317198 = addInt(i_503317198, 1);
          }
      } while (false);
    } while (false);

  
}

function isFatPointer_33557131(ti_33557132) {
  var result_33557133 = false;

  BeforeRet: do {
    result_33557133 = !((ConstSet1[ti_33557132.base.kind] != undefined));
    break BeforeRet;
  } while (false);

  return result_33557133;

}

function nimCopyAux(dest_33557144, src_33557145, n_33557146) {
    switch (n_33557146.kind) {
    case 0:
      break;
    case 1:
            dest_33557144[n_33557146.offset] = nimCopy(dest_33557144[n_33557146.offset], src_33557145[n_33557146.offset], n_33557146.typ);
    
      break;
    case 2:
          for (var i = 0; i < n_33557146.sons.length; i++) {
      nimCopyAux(dest_33557144, src_33557145, n_33557146.sons[i]);
    }
    
      break;
    case 3:
            dest_33557144[n_33557146.offset] = nimCopy(dest_33557144[n_33557146.offset], src_33557145[n_33557146.offset], n_33557146.typ);
      for (var i = 0; i < n_33557146.sons.length; ++i) {
        nimCopyAux(dest_33557144, src_33557145, n_33557146.sons[i][1]);
      }
    
      break;
    }

  
}

function createColor_503316541(r_503316542, g_503316543, b_503316544, a_503316545) {
  var result_503316546 = ({r: 0, g: 0, b: 0, a: 0});

    result_503316546 = nimCopy(result_503316546, {r: r_503316542, g: g_503316543, b: b_503316544, a: a_503316545}, NTI503316503);

  return result_503316546;

}

function raiseRangeError() {
    raiseException({message: makeNimstrLit("value out of range"), parent: null, m_type: NTI33555130, name: null, trace: [], up: null}, "RangeDefect");

  
}

function addChars_251658415(result_251658417, result_251658417_Idx, x_251658418, start_251658419, n_251658420) {
    var old_251658421 = (result_251658417[result_251658417_Idx]).length;
    (result_251658417[result_251658417_Idx].length = chckRange(addInt(old_251658421, n_251658420), 0, 2147483647));
    Label1: do {
      var iHEX60gensym4_251658435 = 0;
      var i_503317217 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(i_503317217 < n_251658420)) break Label3;
            iHEX60gensym4_251658435 = i_503317217;
            result_251658417[result_251658417_Idx][chckIndx(addInt(old_251658421, iHEX60gensym4_251658435), 0, (result_251658417[result_251658417_Idx]).length - 1)] = x_251658418.charCodeAt(chckIndx(addInt(start_251658419, iHEX60gensym4_251658435), 0, (x_251658418).length - 1));
            i_503317217 = addInt(i_503317217, 1);
          }
      } while (false);
    } while (false);

  
}

function addChars_251658411(result_251658413, result_251658413_Idx, x_251658414) {
    addChars_251658415(result_251658413, result_251658413_Idx, x_251658414, 0, ((x_251658414) == null ? 0 : (x_251658414).length));

  
}

function addInt_251658436(result_251658437, result_251658437_Idx, x_251658438) {
    addChars_251658411(result_251658437, result_251658437_Idx, ((x_251658438) + ""));

  
}

function addInt_251658457(result_251658458, result_251658458_Idx, x_251658459) {
    addInt_251658436(result_251658458, result_251658458_Idx, x_251658459);

  
}

function HEX24_352321539(x_352321540) {
  var result_352321541 = [[]];

    addInt_251658457(result_352321541, 0, x_352321540);

  return result_352321541[0];

}

function raiseIndexError(i_33556754, a_33556755, b_33556756) {
    var Temporary1;

    if ((b_33556756 < a_33556755)) {
    Temporary1 = makeNimstrLit("index out of bounds, the container is empty");
    }
    else {
    Temporary1 = (makeNimstrLit("index ") || []).concat(HEX24_352321539(i_33556754) || [],makeNimstrLit(" not in ") || [],HEX24_352321539(a_33556755) || [],makeNimstrLit(" .. ") || [],HEX24_352321539(b_33556756) || []);
    }
    
    raiseException({message: nimCopy(null, Temporary1, NTI33554439), parent: null, m_type: NTI33555128, name: null, trace: [], up: null}, "IndexDefect");

  
}

function vec3_1174405126(x_1174405127, y_1174405128, z_1174405129) {
  var result_1174405130 = ({x: 0.0, y: 0.0, z: 0.0});

    result_1174405130 = nimCopy(result_1174405130, {x: x_1174405127, y: y_1174405128, z: z_1174405129}, NTI1174405123);

  return result_1174405130;

}

function rotateX_1174405179(v_1174405180, angle_1174405181) {
  var result_1174405182 = ({x: 0.0, y: 0.0, z: 0.0});

    var c_1174405186 = Math.cos(angle_1174405181);
    var s_1174405190 = Math.sin(angle_1174405181);
    result_1174405182 = nimCopy(result_1174405182, vec3_1174405126(v_1174405180.x, ((v_1174405180.y * c_1174405186) - (v_1174405180.z * s_1174405190)), ((v_1174405180.y * s_1174405190) + (v_1174405180.z * c_1174405186))), NTI1174405123);

  return result_1174405182;

}

function rotateY_1174405167(v_1174405168, angle_1174405169) {
  var result_1174405170 = ({x: 0.0, y: 0.0, z: 0.0});

    var c_1174405174 = Math.cos(angle_1174405169);
    var s_1174405178 = Math.sin(angle_1174405169);
    result_1174405170 = nimCopy(result_1174405170, vec3_1174405126(((v_1174405168.x * c_1174405174) + (v_1174405168.z * s_1174405178)), v_1174405168.y, ((-(v_1174405168.x) * s_1174405178) + (v_1174405168.z * c_1174405174))), NTI1174405123);

  return result_1174405170;

}

function HEX2D_1174405144(a_1174405145, b_1174405146) {
  var result_1174405147 = ({x: 0.0, y: 0.0, z: 0.0});

    result_1174405147 = nimCopy(result_1174405147, vec3_1174405126((a_1174405145.x - b_1174405146.x), (a_1174405145.y - b_1174405146.y), (a_1174405145.z - b_1174405146.z)), NTI1174405123);

  return result_1174405147;

}

function cross_1174405156(a_1174405157, b_1174405158) {
  var result_1174405159 = ({x: 0.0, y: 0.0, z: 0.0});

    result_1174405159 = nimCopy(result_1174405159, vec3_1174405126(((a_1174405157.y * b_1174405158.z) - (a_1174405157.z * b_1174405158.y)), ((a_1174405157.z * b_1174405158.x) - (a_1174405157.x * b_1174405158.z)), ((a_1174405157.x * b_1174405158.y) - (a_1174405157.y * b_1174405158.x))), NTI1174405123);

  return result_1174405159;

}

function max_33556208(x_33556209, y_33556210) {
    var Temporary1;
      var Temporary2;

  var result_33556211 = 0.0;

      if ((y_33556210 <= x_33556209)) Temporary2 = true; else {        Temporary2 = !((y_33556210 == y_33556210));      }    if (Temporary2) {
    Temporary1 = x_33556209;
    }
    else {
    Temporary1 = y_33556210;
    }
    
    result_33556211 = Temporary1;

  return result_33556211;

}

function project_503316652(r_503316653, v_503316654) {
  var result_503316658 = {Field0: 0, Field1: 0, Field2: 0.0};

    var rotated_503316659 = rotateX_1174405179(rotateY_1174405167(v_503316654, r_503316653.rotationY), r_503316653.rotationX);
    var fov_503316660 = 2.0;
    var z_503316661 = (rotated_503316659.z + 3.0);
    var scale_503316662 = (fov_503316660 / max_33556208(z_503316661, 0.1));
    var x_503316663 = ((((((rotated_503316659.x * scale_503316662) + 1.0) * r_503316653.width) / 2.0)) | 0);
    var y_503316664 = ((((((rotated_503316659.y * scale_503316662) + 1.0) * r_503316653.height) / 2.0)) | 0);
    var colontmp__503317219 = x_503316663;
    var colontmp__503317220 = y_503316664;
    var colontmp__503317221 = rotated_503316659.z;
    result_503316658 = nimCopy(result_503316658, {Field0: colontmp__503317219, Field1: colontmp__503317220, Field2: colontmp__503317221}, NTI503316580);

  return result_503316658;

}

function isInsideFrustum_503316677(r_503316678, p_503316682) {
    var Temporary1;
    var Temporary2;
    var Temporary3;
    var Temporary4;

  var result_503316683 = false;

    var margin_503316684 = 50;
    if (!(negInt(margin_503316684) <= p_503316682.Field0)) Temporary4 = false; else {      Temporary4 = (p_503316682.Field0 < addInt(r_503316678.width, margin_503316684));    }    if (!Temporary4) Temporary3 = false; else {      Temporary3 = (negInt(margin_503316684) <= p_503316682.Field1);    }    if (!Temporary3) Temporary2 = false; else {      Temporary2 = (p_503316682.Field1 < addInt(r_503316678.height, margin_503316684));    }    if (!Temporary2) Temporary1 = false; else {      Temporary1 = (-10.0 < p_503316682.Field2);    }    result_503316683 = Temporary1;

  return result_503316683;

}

function triangleVisible_503316685(r_503316686, p0_503316690, p1_503316691, p2_503316692) {
  var result_503316693 = false;

    result_503316693 = ((isInsideFrustum_503316677(r_503316686, p0_503316690) || isInsideFrustum_503316677(r_503316686, p1_503316691)) || isInsideFrustum_503316677(r_503316686, p2_503316692));

  return result_503316693;

}

function sysFatal_218103842(message_218103845) {
    raiseException({message: nimCopy(null, message_218103845, NTI33554439), m_type: NTI33555124, parent: null, name: null, trace: [], up: null}, "AssertionDefect");

  
}

function raiseAssert_218103840(msg_218103841) {
    sysFatal_218103842(msg_218103841);

  
}

function failedAssertImpl_218103864(msg_218103865) {
    raiseAssert_218103840(msg_218103865);

  
}

function newSeq_503316793(len_503316795) {
  var result_503316796 = [];

    result_503316796 = new Array(len_503316795); for (var i = 0 ; i < len_503316795 ; ++i) { result_503316796[i] = {Field0: {Field0: 0, Field1: 0, Field2: 0}, Field1: 0.0, Field2: ({x: 0.0, y: 0.0, z: 0.0}), Field3: ({x: 0.0, y: 0.0, z: 0.0}), Field4: ({x: 0.0, y: 0.0, z: 0.0}), Field5: {Field0: 0, Field1: 0, Field2: 0.0}, Field6: {Field0: 0, Field1: 0, Field2: 0.0}, Field7: {Field0: 0, Field1: 0, Field2: 0.0}}; }
  return result_503316796;

}

function raiseDivByZero() {
    raiseException({message: makeNimstrLit("division by zero"), parent: null, m_type: NTI33555121, name: null, trace: [], up: null}, "DivByZeroDefect");

  
}

function HEX2A_922746888(x_922746889, order_922746890) {
  var result_922746891 = 0;

    var y_922746896 = subInt(order_922746890, 1);
    result_922746891 = subInt((x_922746889 ^ y_922746896), y_922746896);

  return result_922746891;

}

function mergeAlt_503316822(a_503316824, b_503316825, lo_503316826, m_503316827, hi_503316828, cmp_503316831, order_503316832) {
  BeforeRet: do {
    if ((HEX2A_922746888(cmp_503316831(a_503316824[chckIndx(m_503316827, 0, (a_503316824).length - 1)], a_503316824[chckIndx(addInt(m_503316827, 1), 0, (a_503316824).length - 1)]), order_503316832) <= 0)) {
    break BeforeRet;
    }
    
    var j_503316833 = lo_503316826;
    if (!((j_503316833 <= m_503316827))) {
    failedAssertImpl_218103864(makeNimstrLit("algorithm.nim(334, 10) `j <= m` "));
    }
    
    var bb_503316839 = 0;
    Label1: do {
        Label2: while (true) {
        if (!(j_503316833 <= m_503316827)) break Label2;
          b_503316825[chckIndx(bb_503316839, 0, (b_503316825).length - 1)] = nimCopy(b_503316825[chckIndx(bb_503316839, 0, (b_503316825).length - 1)], a_503316824[chckIndx(j_503316833, 0, (a_503316824).length - 1)], NTI503316595);
          bb_503316839 = addInt(bb_503316839, 1);
          j_503316833 = addInt(j_503316833, 1);
        }
    } while (false);
    var i_503316848 = 0;
    var k_503316849 = lo_503316826;
    Label3: do {
        Label4: while (true) {
        if (!((k_503316849 < j_503316833) && (j_503316833 <= hi_503316828))) break Label4;
          if ((HEX2A_922746888(cmp_503316831(b_503316825[chckIndx(i_503316848, 0, (b_503316825).length - 1)], a_503316824[chckIndx(j_503316833, 0, (a_503316824).length - 1)]), order_503316832) <= 0)) {
          a_503316824[chckIndx(k_503316849, 0, (a_503316824).length - 1)] = nimCopy(a_503316824[chckIndx(k_503316849, 0, (a_503316824).length - 1)], b_503316825[chckIndx(i_503316848, 0, (b_503316825).length - 1)], NTI503316595);
          i_503316848 = addInt(i_503316848, 1);
          }
          else {
            a_503316824[chckIndx(k_503316849, 0, (a_503316824).length - 1)] = nimCopy(a_503316824[chckIndx(k_503316849, 0, (a_503316824).length - 1)], a_503316824[chckIndx(j_503316833, 0, (a_503316824).length - 1)], NTI503316595);
            j_503316833 = addInt(j_503316833, 1);
          }
          
          k_503316849 = addInt(k_503316849, 1);
        }
    } while (false);
    Label5: do {
        Label6: while (true) {
        if (!(k_503316849 < j_503316833)) break Label6;
          a_503316824[chckIndx(k_503316849, 0, (a_503316824).length - 1)] = nimCopy(a_503316824[chckIndx(k_503316849, 0, (a_503316824).length - 1)], b_503316825[chckIndx(i_503316848, 0, (b_503316825).length - 1)], NTI503316595);
          k_503316849 = addInt(k_503316849, 1);
          i_503316848 = addInt(i_503316848, 1);
        }
    } while (false);
  } while (false);

  
}

function sort_503316781(a_503316783, cmp_503316786, order_503316787) {
    var n_503316792 = (a_503316783).length;
    var b_503316819 = newSeq_503316793(chckRange(divInt(n_503316792, 2), 0, 2147483647));
    var s_503316820 = 1;
    Label1: do {
        Label2: while (true) {
        if (!(s_503316820 < n_503316792)) break Label2;
          var m_503316821 = subInt(subInt(n_503316792, 1), s_503316820);
          Label3: do {
              Label4: while (true) {
              if (!(0 <= m_503316821)) break Label4;
                mergeAlt_503316822(a_503316783, b_503316819, nimMax(addInt(subInt(m_503316821, s_503316820), 1), 0), m_503316821, addInt(m_503316821, s_503316820), cmp_503316786, order_503316787);
                m_503316821 = subInt(m_503316821, mulInt(s_503316820, 2));
              }
          } while (false);
          s_503316820 = mulInt(s_503316820, 2);
        }
    } while (false);

  
}

function drawLine_503316602(r_503316603, x0_503316604, y0_503316605, x1_503316606, y1_503316607, c_503316608) {
    var Temporary5;

    var x0_503316609 = x0_503316604;
    var y0_503316610 = y0_503316605;
    var x1_503316611 = x1_503316606;
    var y1_503316612 = y1_503316607;
    var steep_503316613 = false;
    if ((absInt(subInt(x0_503316609, x1_503316611)) < absInt(subInt(y0_503316610, y1_503316612)))) {
    var Temporary1 = x0_503316609; x0_503316609 = y0_503316610; y0_503316610 = Temporary1;    var Temporary2 = x1_503316611; x1_503316611 = y1_503316612; y1_503316612 = Temporary2;    steep_503316613 = true;
    }
    
    if ((x1_503316611 < x0_503316609)) {
    var Temporary3 = x0_503316609; x0_503316609 = x1_503316611; x1_503316611 = Temporary3;    var Temporary4 = y0_503316610; y0_503316610 = y1_503316612; y1_503316612 = Temporary4;    }
    
    var dx_503316630 = subInt(x1_503316611, x0_503316609);
    var dy_503316631 = absInt(subInt(y1_503316612, y0_503316610));
    var error_503316632 = 0;
    var y_503316633 = y0_503316610;
    if ((y0_503316610 < y1_503316612)) {
    Temporary5 = 1;
    }
    else {
    Temporary5 = -1;
    }
    
    var yStep_503316634 = Temporary5;
    Label6: do {
      var x_503316639 = 0;
      var res_503317228 = x0_503316609;
      Label7: do {
          Label8: while (true) {
          if (!(res_503317228 <= x1_503316611)) break Label8;
            x_503316639 = res_503317228;
            if (steep_503316613) {
            setPixel_503316562(r_503316603, y_503316633, x_503316639, c_503316608);
            }
            else {
            setPixel_503316562(r_503316603, x_503316639, y_503316633, c_503316608);
            }
            
            error_503316632 = addInt(error_503316632, mulInt(dy_503316631, 2));
            if ((dx_503316630 < error_503316632)) {
            y_503316633 = addInt(y_503316633, yStep_503316634);
            error_503316632 = subInt(error_503316632, mulInt(dx_503316630, 2));
            }
            
            res_503317228 = addInt(res_503317228, 1);
          }
      } while (false);
    } while (false);

  
}

function drawModel_503316695(r_503316696, wireColor_503316697) {
    
function HEX3Aanonymous_503316773(a_503316774, b_503316775) {
        var Temporary1;

      var result_503316776 = 0;

        if ((b_503316775.Field1 < a_503316774.Field1)) {
        Temporary1 = -1;
        }
        else {
        if ((a_503316774.Field1 < b_503316775.Field1)) {
        Temporary1 = 1;
        }
        else {
        Temporary1 = 0;
        }
        }
        result_503316776 = Temporary1;

      return result_503316776;

    }

    var visibleFaces_503316725 = [];
    Label1: do {
      var face_503316747 = {Field0: 0, Field1: 0, Field2: 0};
      var i_503317205 = 0;
      var L_503317206 = (r_503316696.model.faces).length;
      Label2: do {
          Label3: while (true) {
          if (!(i_503317205 < L_503317206)) break Label3;
            face_503316747 = r_503316696.model.faces[chckIndx(i_503317205, 0, (r_503316696.model.faces).length - 1)];
            Label4: do {
              var v0_503316748 = nimCopy(null, r_503316696.model.vertices[chckIndx(face_503316747.Field0, 0, (r_503316696.model.vertices).length - 1)], NTI1174405123);
              var v1_503316749 = nimCopy(null, r_503316696.model.vertices[chckIndx(face_503316747.Field1, 0, (r_503316696.model.vertices).length - 1)], NTI1174405123);
              var v2_503316750 = nimCopy(null, r_503316696.model.vertices[chckIndx(face_503316747.Field2, 0, (r_503316696.model.vertices).length - 1)], NTI1174405123);
              var rv0_503316751 = rotateX_1174405179(rotateY_1174405167(v0_503316748, r_503316696.rotationY), r_503316696.rotationX);
              var rv1_503316752 = rotateX_1174405179(rotateY_1174405167(v1_503316749, r_503316696.rotationY), r_503316696.rotationX);
              var rv2_503316753 = rotateX_1174405179(rotateY_1174405167(v2_503316750, r_503316696.rotationY), r_503316696.rotationX);
              var edge1_503316754 = HEX2D_1174405144(rv1_503316752, rv0_503316751);
              var edge2_503316755 = HEX2D_1174405144(rv2_503316753, rv0_503316751);
              var normal_503316756 = cross_1174405156(edge1_503316754, edge2_503316755);
              if ((0.0 <= normal_503316756.z)) {
              break Label4;
              }
              
              var p0_503316757 = project_503316652(r_503316696, v0_503316748);
              var p1_503316758 = project_503316652(r_503316696, v1_503316749);
              var p2_503316759 = project_503316652(r_503316696, v2_503316750);
              if (!(triangleVisible_503316685(r_503316696, p0_503316757, p1_503316758, p2_503316759))) {
              break Label4;
              }
              
              var avgDepth_503316760 = (((rv0_503316751.z + rv1_503316752.z) + rv2_503316753.z) / 3.0);
              visibleFaces_503316725.push({Field0: nimCopy(null, face_503316747, NTI503316505), Field1: avgDepth_503316760, Field2: nimCopy(null, rv0_503316751, NTI1174405123), Field3: nimCopy(null, rv1_503316752, NTI1174405123), Field4: nimCopy(null, rv2_503316753, NTI1174405123), Field5: nimCopy(null, p0_503316757, NTI503316596), Field6: nimCopy(null, p1_503316758, NTI503316596), Field7: nimCopy(null, p2_503316759, NTI503316596)});;
            } while (false);
            i_503317205 = addInt(i_503317205, 1);
            if (!(((r_503316696.model.faces).length == L_503317206))) {
            failedAssertImpl_218103864(makeNimstrLit("iterators.nim(240, 11) `len(a) == L` the length of the seq changed while iterating over it"));
            }
            
          }
      } while (false);
    } while (false);
    sort_503316781(visibleFaces_503316725, HEX3Aanonymous_503316773, 1);
    Label5: do {
      var fd_503316904 = {Field0: {Field0: 0, Field1: 0, Field2: 0}, Field1: 0.0, Field2: ({x: 0.0, y: 0.0, z: 0.0}), Field3: ({x: 0.0, y: 0.0, z: 0.0}), Field4: ({x: 0.0, y: 0.0, z: 0.0}), Field5: {Field0: 0, Field1: 0, Field2: 0.0}, Field6: {Field0: 0, Field1: 0, Field2: 0.0}, Field7: {Field0: 0, Field1: 0, Field2: 0.0}};
      var i_503317210 = 0;
      var L_503317211 = (visibleFaces_503316725).length;
      Label6: do {
          Label7: while (true) {
          if (!(i_503317210 < L_503317211)) break Label7;
            fd_503316904 = visibleFaces_503316725[chckIndx(i_503317210, 0, (visibleFaces_503316725).length - 1)];
            drawLine_503316602(r_503316696, fd_503316904.Field5.Field0, fd_503316904.Field5.Field1, fd_503316904.Field6.Field0, fd_503316904.Field6.Field1, wireColor_503316697);
            drawLine_503316602(r_503316696, fd_503316904.Field6.Field0, fd_503316904.Field6.Field1, fd_503316904.Field7.Field0, fd_503316904.Field7.Field1, wireColor_503316697);
            drawLine_503316602(r_503316696, fd_503316904.Field7.Field0, fd_503316904.Field7.Field1, fd_503316904.Field5.Field0, fd_503316904.Field5.Field1, wireColor_503316697);
            i_503317210 = addInt(i_503317210, 1);
            if (!(((visibleFaces_503316725).length == L_503317211))) {
            failedAssertImpl_218103864(makeNimstrLit("iterators.nim(240, 11) `len(a) == L` the length of the seq changed while iterating over it"));
            }
            
          }
      } while (false);
    } while (false);

  
}

function greenColor_503316558() {
  var result_503316559 = ({r: 0, g: 0, b: 0, a: 0});

    result_503316559 = nimCopy(result_503316559, createColor_503316541(0, 255, 100, 255), NTI503316503);

  return result_503316559;

}

function render_503316968(r_503316969) {
    clear_503316589(r_503316969, createColor_503316541(20, 20, 30, 255));
    if ((0 < (r_503316969.model.vertices).length)) {
    drawModel_503316695(r_503316969, greenColor_503316558());
    }
    
    r_503316969.ctx.putImageData(r_503316969.imageData, 0, 0);

  
}

function animate(timestamp_503317171) {
      var Temporary1;

      if (!renderer_503316531[0].autoRotate) Temporary1 = false; else {        Temporary1 = !(renderer_503316531[0].dragging);      }    if (Temporary1) {
    HEX2BHEX3D_989857831(renderer_503316531[0], "rotationY", 0.01);
    }
    
    render_503316968(renderer_503316531[0]);
    var _ = window.requestAnimationFrame(animate);

  
}

function substr_33557906(s_33557907, first_33557908, last_33557909) {
  var result_33557910 = [];

    var first_33557911 = nimMax(first_33557908, 0);
    var L_33557912 = nimMax(addInt(subInt(nimMin(last_33557909, (s_33557907).length - 1), first_33557911), 1), 0);
    result_33557910 = nimCopy(null, mnewString(chckRange(L_33557912, 0, 2147483647)), NTI33554439);
    Label1: do {
      var i_33557917 = 0;
      var colontmp__503317394 = 0;
      colontmp__503317394 = subInt(L_33557912, 1);
      var res_503317395 = 0;
      Label2: do {
          Label3: while (true) {
          if (!(res_503317395 <= colontmp__503317394)) break Label3;
            i_33557917 = res_503317395;
            result_33557910[chckIndx(i_33557917, 0, (result_33557910).length - 1)] = s_33557907[chckIndx(addInt(i_33557917, first_33557911), 0, (s_33557907).length - 1)];
            res_503317395 = addInt(res_503317395, 1);
          }
      } while (false);
    } while (false);

  return result_33557910;

}

function nsuSplitWhitespace(s_989856384, maxsplit_989856385) {
  var result_989856386 = [];

    result_989856386 = nimCopy(null, [], NTI989856224);
    Label1: do {
      var xHEX60gensym76_989856392 = [];
      var lastHEX60gensym58_503317401 = 0;
      var splitsHEX60gensym58_503317402 = maxsplit_989856385;
      if (false) {
      failedAssertImpl_218103864(makeNimstrLit("strutils.nim(382, 9) `not (\'\\x00\' in Whitespace)` "));
      }
      
      Label2: do {
          Label3: while (true) {
          if (!(lastHEX60gensym58_503317401 < (s_989856384).length)) break Label3;
            Label4: do {
                Label5: while (true) {
                if (!((lastHEX60gensym58_503317401 < (s_989856384).length) && (ConstSet3[s_989856384[chckIndx(lastHEX60gensym58_503317401, 0, (s_989856384).length - 1)]] != undefined))) break Label5;
                  lastHEX60gensym58_503317401 = addInt(lastHEX60gensym58_503317401, 1);
                }
            } while (false);
            var firstHEX60gensym58_503317405 = lastHEX60gensym58_503317401;
            Label6: do {
                Label7: while (true) {
                if (!((lastHEX60gensym58_503317401 < (s_989856384).length) && !((ConstSet4[s_989856384[chckIndx(lastHEX60gensym58_503317401, 0, (s_989856384).length - 1)]] != undefined)))) break Label7;
                  lastHEX60gensym58_503317401 = addInt(lastHEX60gensym58_503317401, 1);
                }
            } while (false);
            if ((firstHEX60gensym58_503317405 <= subInt(lastHEX60gensym58_503317401, 1))) {
            if ((splitsHEX60gensym58_503317402 == 0)) {
            lastHEX60gensym58_503317401 = (s_989856384).length;
            }
            
            xHEX60gensym76_989856392 = substr_33557906(s_989856384, firstHEX60gensym58_503317405, subInt(lastHEX60gensym58_503317401, 1));
            var Temporary8 = nimCopy(null, xHEX60gensym76_989856392, NTI33554439);
            result_989856386.push(Temporary8);;
            if ((splitsHEX60gensym58_503317402 == 0)) {
            break Label2;
            }
            
            splitsHEX60gensym58_503317402 = subInt(splitsHEX60gensym58_503317402, 1);
            }
            
          }
      } while (false);
    } while (false);

  return result_989856386;

}

function parseFloatNative_33557268(a_33557269) {
  var result_33557270 = 0.0;

    var a2_33557271 = toJSStr(a_33557269);
      result_33557270 = Number(a2_33557271);
  

  return result_33557270;

}

function npuParseFloat(s_1006633372, number_1006633373, number_1006633373_Idx, start_1006633374) {
  var result_1006633375 = 0;

    var bf_1006633376 = [0.0];
    result_1006633375 = nimParseBiggestFloat(s_1006633372, bf_1006633376, 0, start_1006633374);
    if (!((result_1006633375 == 0))) {
    number_1006633373[number_1006633373_Idx] = bf_1006633376[0];
    }
    

  return result_1006633375;

}

function nsuParseFloat(s_989856562) {
      var Temporary1;

  var result_989856563 = [0.0];

    result_989856563[0] = 0.0;
    var L_989856564 = npuParseFloat(s_989856562, result_989856563, 0, 0);
      if (!((L_989856564 == (s_989856562).length))) Temporary1 = true; else {        Temporary1 = (L_989856564 == 0);      }    if (Temporary1) {
    raiseException({message: (makeNimstrLit("invalid float: ") || []).concat(s_989856562 || []), parent: null, m_type: NTI33555125, name: null, trace: [], up: null}, "ValueError");
    }
    

  return result_989856563[0];

}

function nsuSplitChar(s_989856235, sep_989856236, maxsplit_989856237) {
  var result_989856238 = [];

    result_989856238 = nimCopy(null, [], NTI989856072);
    Label1: do {
      var xHEX60gensym66_989856244 = [];
      var lastHEX60gensym33_503317416 = 0;
      var splitsHEX60gensym33_503317417 = maxsplit_989856237;
      Label2: do {
          Label3: while (true) {
          if (!(lastHEX60gensym33_503317416 <= (s_989856235).length)) break Label3;
            var firstHEX60gensym33_503317419 = lastHEX60gensym33_503317416;
            Label4: do {
                Label5: while (true) {
                if (!((lastHEX60gensym33_503317416 < (s_989856235).length) && !((s_989856235[chckIndx(lastHEX60gensym33_503317416, 0, (s_989856235).length - 1)] == sep_989856236)))) break Label5;
                  lastHEX60gensym33_503317416 = addInt(lastHEX60gensym33_503317416, 1);
                }
            } while (false);
            if ((splitsHEX60gensym33_503317417 == 0)) {
            lastHEX60gensym33_503317416 = (s_989856235).length;
            }
            
            xHEX60gensym66_989856244 = substr_33557906(s_989856235, firstHEX60gensym33_503317419, subInt(lastHEX60gensym33_503317416, 1));
            var Temporary6 = nimCopy(null, xHEX60gensym66_989856244, NTI33554439);
            result_989856238.push(Temporary6);;
            if ((splitsHEX60gensym33_503317417 == 0)) {
            break Label2;
            }
            
            splitsHEX60gensym33_503317417 = subInt(splitsHEX60gensym33_503317417, 1);
            lastHEX60gensym33_503317416 = addInt(lastHEX60gensym33_503317416, 1);
          }
      } while (false);
    } while (false);

  return result_989856238;

}

function integerOutOfRangeError_1006633208() {
    raiseException({message: makeNimstrLit("Parsed integer outside of valid range"), parent: null, m_type: NTI33555125, name: null, trace: [], up: null}, "ValueError");

  
}

function rawParseInt_1006633210(s_1006633211, b_1006633212, b_1006633212_Idx, start_1006633213) {
      var Temporary1;
          var Temporary4;
      var Temporary7;

  var result_1006633214 = 0;

    var sign_1006633215 = -1;
    var i_1006633216 = start_1006633213;
    if ((i_1006633216 < (s_1006633211).length)) {
    if ((s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)] == 43)) {
    i_1006633216 += 1;
    }
    else {
    if ((s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)] == 45)) {
    i_1006633216 += 1;
    sign_1006633215 = 1;
    }
    }
    }
    
      if (!(i_1006633216 < (s_1006633211).length)) Temporary1 = false; else {        Temporary1 = (ConstSet12[s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)]] != undefined);      }    if (Temporary1) {
    b_1006633212[b_1006633212_Idx] = 0;
    Label2: do {
        Label3: while (true) {
          if (!(i_1006633216 < (s_1006633211).length)) Temporary4 = false; else {            Temporary4 = (ConstSet13[s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)]] != undefined);          }        if (!Temporary4) break Label3;
          var c_1006633239 = (s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)] - 48);
          if ((Math.trunc((-9223372036854775808 + c_1006633239) / 10) <= b_1006633212[b_1006633212_Idx])) {
          b_1006633212[b_1006633212_Idx] = ((b_1006633212[b_1006633212_Idx] * 10) - c_1006633239);
          }
          else {
          integerOutOfRangeError_1006633208();
          }
          
          i_1006633216 += 1;
          Label5: do {
              Label6: while (true) {
              if (!((i_1006633216 < (s_1006633211).length) && (s_1006633211[chckIndx(i_1006633216, 0, (s_1006633211).length - 1)] == 95))) break Label6;
                i_1006633216 += 1;
              }
          } while (false);
        }
    } while (false);
      if (!(sign_1006633215 == -1)) Temporary7 = false; else {        Temporary7 = (b_1006633212[b_1006633212_Idx] == -9223372036854775808);      }    if (Temporary7) {
    integerOutOfRangeError_1006633208();
    }
    else {
      b_1006633212[b_1006633212_Idx] = (b_1006633212[b_1006633212_Idx] * sign_1006633215);
      result_1006633214 = (i_1006633216 - start_1006633213);
    }
    
    }
    

  return result_1006633214;

}

function npuParseBiggestInt(s_1006633257, number_1006633258, number_1006633258_Idx, start_1006633259) {
  var result_1006633260 = 0;

    var res_1006633261 = [0];
    result_1006633260 = rawParseInt_1006633210(s_1006633257, res_1006633261, 0, start_1006633259);
    if (!((result_1006633260 == 0))) {
    number_1006633258[number_1006633258_Idx] = res_1006633261[0];
    }
    

  return result_1006633260;

}

function npuParseInt(s_1006633263, number_1006633264, number_1006633264_Idx, start_1006633265) {
      var Temporary1;

  var result_1006633266 = 0;

    var res_1006633267 = [0];
    result_1006633266 = npuParseBiggestInt(s_1006633263, res_1006633267, 0, start_1006633265);
      if ((res_1006633267[0] < -2147483648)) Temporary1 = true; else {        Temporary1 = (2147483647 < res_1006633267[0]);      }    if (Temporary1) {
    integerOutOfRangeError_1006633208();
    }
    
    if (!((result_1006633266 == 0))) {
    number_1006633264[number_1006633264_Idx] = chckRange(res_1006633267[0], -2147483648, 2147483647);
    }
    

  return result_1006633266;

}

function nsuParseInt(s_989856542) {
      var Temporary1;

  var result_989856543 = [0];

    result_989856543[0] = 0;
    var L_989856544 = npuParseInt(s_989856542, result_989856543, 0, 0);
      if (!((L_989856544 == (s_989856542).length))) Temporary1 = true; else {        Temporary1 = (L_989856544 == 0);      }    if (Temporary1) {
    raiseException({message: (makeNimstrLit("invalid integer: ") || []).concat(s_989856542 || []), parent: null, m_type: NTI33555125, name: null, trace: [], up: null}, "ValueError");
    }
    

  return result_989856543[0];

}

function parseObjContent_503316977(content_503316978) {
            var Temporary6;
                
function parseIndex_503317014(s_503317015) {
                    var Temporary1;

                  var result_503317016 = 0;

                    var idx_503317017 = nimCopy(null, (Temporary1 = nsuSplitChar(s_503317015, 47, -1), Temporary1)[chckIndx(0, 0, (Temporary1).length - 1)], NTI33554439);
                    result_503317016 = subInt(nsuParseInt(idx_503317017), 1);

                  return result_503317016;

                }

  var result_503316979 = ({vertices: [], faces: []});

    var vertices_503316984 = [];
    var faces_503316989 = [];
    Label1: do {
      var line_503316990 = [];
      var first_503317388 = 0;
      var last_503317389 = 0;
      var eolpos_503317390 = 0;
      Label2: do {
          Label3: while (true) {
          if (!true) break Label3;
            Label4: do {
                Label5: while (true) {
                if (!((last_503317389 < (content_503316978).length) && !((ConstSet2[content_503316978[chckIndx(last_503317389, 0, (content_503316978).length - 1)]] != undefined)))) break Label5;
                  last_503317389 = addInt(last_503317389, 1);
                }
            } while (false);
            eolpos_503317390 = last_503317389;
            if ((last_503317389 < (content_503316978).length)) {
            if ((content_503316978[chckIndx(last_503317389, 0, (content_503316978).length - 1)] == 10)) {
            last_503317389 = addInt(last_503317389, 1);
            }
            else {
            if ((content_503316978[chckIndx(last_503317389, 0, (content_503316978).length - 1)] == 13)) {
            last_503317389 = addInt(last_503317389, 1);
            if (((last_503317389 < (content_503316978).length) && (content_503316978[chckIndx(last_503317389, 0, (content_503316978).length - 1)] == 10))) {
            last_503317389 = addInt(last_503317389, 1);
            }
            
            }
            }
            }
            
            if (false) {
            Temporary6 = subInt(last_503317389, 1);
            }
            else {
            Temporary6 = subInt(eolpos_503317390, 1);
            }
            
            line_503316990 = substr_33557906(content_503316978, first_503317388, Temporary6);
            Label7: do {
              var parts_503316991 = nsuSplitWhitespace(line_503316990, -1);
              if (((parts_503316991).length == 0)) {
              break Label7;
              }
              
              switch (toJSStr(parts_503316991[chckIndx(0, 0, (parts_503316991).length - 1)])) {
              case "v":
                if ((4 <= (parts_503316991).length)) {
                var x_503317001 = nsuParseFloat(parts_503316991[chckIndx(1, 0, (parts_503316991).length - 1)]);
                var y_503317002 = nsuParseFloat(parts_503316991[chckIndx(2, 0, (parts_503316991).length - 1)]);
                var z_503317003 = nsuParseFloat(parts_503316991[chckIndx(3, 0, (parts_503316991).length - 1)]);
                vertices_503316984.push(vec3_1174405126(x_503317001, y_503317002, z_503317003));;
                }
                
                break;
              case "f":
                if ((4 <= (parts_503316991).length)) {
                var i0_503317018 = parseIndex_503317014(parts_503316991[chckIndx(1, 0, (parts_503316991).length - 1)]);
                var i1_503317019 = parseIndex_503317014(parts_503316991[chckIndx(2, 0, (parts_503316991).length - 1)]);
                var i2_503317020 = parseIndex_503317014(parts_503316991[chckIndx(3, 0, (parts_503316991).length - 1)]);
                faces_503316989.push({Field0: i0_503317018, Field1: i1_503317019, Field2: i2_503317020});;
                if ((5 <= (parts_503316991).length)) {
                var i3_503317034 = parseIndex_503317014(parts_503316991[chckIndx(4, 0, (parts_503316991).length - 1)]);
                faces_503316989.push({Field0: i0_503317018, Field1: i2_503317020, Field2: i3_503317034});;
                }
                
                }
                
                break;
              default: 
                break;
              }
            } while (false);
            if ((eolpos_503317390 == last_503317389)) {
            break Label2;
            }
            
            first_503317388 = last_503317389;
          }
      } while (false);
    } while (false);
    result_503316979 = nimCopy(result_503316979, {vertices: nimCopy(null, vertices_503316984, NTI503316751), faces: nimCopy(null, faces_503316989, NTI503316760)}, NTI503316506);

  return result_503316979;

}
async function loadModel_503317107(url_503317108) {
  var result_503317111 = null;

    var response_503317125 = (await fetch(toJSStr(url_503317108)));
    var text_503317130 = (await response_503317125.text());
    result_503317111 = parseObjContent_503316977(cstrToNimstr(text_503317130));

  return result_503317111;

}

function selectModel(url_503317354) {
    async function load_503317356() {
      var result_503317358 = null;

      BeforeRet: do {
        var statusEl_503317364 = document.getElementById("status");
        statusEl_503317364.innerHTML = "Loading model...";
        renderer_503316531[0].model = nimCopy(renderer_503316531[0].model, (await loadModel_503317107(cstrToNimstr(url_503317354))), NTI503316506);
        statusEl_503317364.innerHTML = toJSStr((makeNimstrLit("Vertices: ") || []).concat(HEX24_352321539((renderer_503316531[0].model.vertices).length) || [],makeNimstrLit(" | Faces: ") || [],HEX24_352321539((renderer_503316531[0].model.faces).length) || [],makeNimstrLit(" | Drag to rotate") || []));
        result_503317358 = undefined;
        break BeforeRet;
      } while (false);

      return result_503317358;

    }

    var _ = load_503317356();

  
}

function toggleAutoRotate() {
    renderer_503316531[0].autoRotate = !(renderer_503316531[0].autoRotate);
    var btn_503317424 = document.getElementById("autoRotateBtn");
    if (renderer_503316531[0].autoRotate) {
    btn_503317424.innerHTML = "Auto-Rotate: ON";
    }
    else {
      btn_503317424.innerHTML = "Auto-Rotate: OFF";
    }
    

  
}

function initRenderer_503317326(canvasId_503317327, width_503317328, height_503317329) {
  var result_503317330 = null;

    var canvas_503317331 = document.getElementById(canvasId_503317327);
    canvas_503317331.setAttribute("width", toJSStr(HEX24_352321539(width_503317328)));
    canvas_503317331.setAttribute("height", toJSStr(HEX24_352321539(height_503317329)));
    var ctx_503317332 = null;
    ctx_503317332 = canvas_503317331.getContext('2d');
    var imageData_503317333 = null;
    imageData_503317333 = ctx_503317332.createImageData(width_503317328, height_503317329);
    var pixels_503317334 = null;
    pixels_503317334 = imageData_503317333.data;
    result_503317330 = {canvas: canvas_503317331, ctx: ctx_503317332, width: width_503317328, height: height_503317329, imageData: imageData_503317333, pixels: pixels_503317334, model: {vertices: [], faces: []}, rotationY: 0.0, rotationX: 0.0, autoRotate: true, dragging: false, lastMouseX: 0, lastMouseY: 0};

  return result_503317330;

}

function setupEventHandlers_503317230(r_503317231) {
    
function HEX3Aanonymous_503317232(e_503317233) {
        var me_503317234 = e_503317233;
        r_503317231.dragging = true;
        r_503317231.lastMouseX = me_503317234.clientX;
        r_503317231.lastMouseY = me_503317234.clientY;

      
    }
    
function HEX3Aanonymous_503317253(e_503317254) {
        r_503317231.dragging = false;

      
    }
    
function HEX3Aanonymous_503317255(e_503317256) {
        if (r_503317231.dragging) {
        var me_503317257 = e_503317256;
        var deltaX_503317258 = subInt(me_503317257.clientX, r_503317231.lastMouseX);
        var deltaY_503317259 = subInt(me_503317257.clientY, r_503317231.lastMouseY);
        HEX2BHEX3D_989857831(r_503317231, "rotationY", (deltaX_503317258 * 0.01));
        HEX2BHEX3D_989857831(r_503317231, "rotationX", (deltaY_503317259 * 0.01));
        r_503317231.lastMouseX = me_503317257.clientX;
        r_503317231.lastMouseY = me_503317257.clientY;
        }
        

      
    }
    
function HEX3Aanonymous_503317268(e_503317269) {
        var te_503317270 = e_503317269;
        if ((0 < (te_503317270.touches).length)) {
        r_503317231.dragging = true;
        r_503317231.lastMouseX = te_503317270.touches[chckIndx(0, 0, (te_503317270.touches).length - 1)].clientX;
        r_503317231.lastMouseY = te_503317270.touches[chckIndx(0, 0, (te_503317270.touches).length - 1)].clientY;
        }
        

      
    }
    
function HEX3Aanonymous_503317287(e_503317288) {
        r_503317231.dragging = false;

      
    }
    
function HEX3Aanonymous_503317289(e_503317290) {
        if (r_503317231.dragging) {
        var te_503317291 = e_503317290;
        if ((0 < (te_503317291.touches).length)) {
        var deltaX_503317298 = subInt(te_503317291.touches[chckIndx(0, 0, (te_503317291.touches).length - 1)].clientX, r_503317231.lastMouseX);
        var deltaY_503317299 = subInt(te_503317291.touches[chckIndx(0, 0, (te_503317291.touches).length - 1)].clientY, r_503317231.lastMouseY);
        HEX2BHEX3D_989857831(r_503317231, "rotationY", (deltaX_503317298 * 0.01));
        HEX2BHEX3D_989857831(r_503317231, "rotationX", (deltaY_503317299 * 0.01));
        r_503317231.lastMouseX = te_503317291.touches[chckIndx(0, 0, (te_503317291.touches).length - 1)].clientX;
        r_503317231.lastMouseY = te_503317291.touches[chckIndx(0, 0, (te_503317291.touches).length - 1)].clientY;
        }
        
        }
        

      
    }

    r_503317231.canvas.addEventListener("mousedown", HEX3Aanonymous_503317232, false);
    document.addEventListener("mouseup", HEX3Aanonymous_503317253, false);
    document.addEventListener("mousemove", HEX3Aanonymous_503317255, false);
    r_503317231.canvas.addEventListener("touchstart", HEX3Aanonymous_503317268, false);
    document.addEventListener("touchend", HEX3Aanonymous_503317287, false);
    document.addEventListener("touchmove", HEX3Aanonymous_503317289, false);

  
}

function main() {
    renderer_503316531[0] = initRenderer_503317326("canvas", 600, 600);
    setupEventHandlers_503317230(renderer_503316531[0]);
    selectModel("models/african_head.obj");
    var _ = window.requestAnimationFrame(animate);

  
}

function HEX3Aanonymous_503317426(e_503317427) {
    main();

  
}
window.onload = HEX3Aanonymous_503317426;
